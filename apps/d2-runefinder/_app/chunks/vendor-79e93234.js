var Qr=Object.defineProperty,$r=Object.defineProperties;var Kr=Object.getOwnPropertyDescriptors;var Ye=Object.getOwnPropertySymbols;var rn=Object.prototype.hasOwnProperty,sn=Object.prototype.propertyIsEnumerable;var ln=(e,t,n)=>t in e?Qr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C=(e,t)=>{for(var n in t||(t={}))rn.call(t,n)&&ln(e,n,t[n]);if(Ye)for(var n of Ye(t))sn.call(t,n)&&ln(e,n,t[n]);return e},Y=(e,t)=>$r(e,Kr(t));var on=(e,t)=>{var n={};for(var r in e)rn.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Ye)for(var r of Ye(e))t.indexOf(r)<0&&sn.call(e,r)&&(n[r]=e[r]);return n};function Te(){}function Tt(e,t){for(const n in t)e[n]=t[n];return e}function an(e){return e()}function cn(){return Object.create(null)}function Ge(e){e.forEach(an)}function Zr(e){return typeof e=="function"}function un(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let We;function ba(e,t){return We||(We=document.createElement("a")),We.href=t,e===We.href}function Jr(e){return Object.keys(e).length===0}function Ma(e,t,n,r){if(e){const s=dn(e,t,n,r);return e[0](s)}}function dn(e,t,n,r){return e[1]&&r?Tt(n.ctx.slice(),e[1](r(t))):n.ctx}function Ca(e,t,n,r){if(e[2]&&r){const s=e[2](r(n));if(t.dirty===void 0)return s;if(typeof s=="object"){const l=[],i=Math.max(t.dirty.length,s.length);for(let a=0;a<i;a+=1)l[a]=t.dirty[a]|s[a];return l}return t.dirty|s}return t.dirty}function Na(e,t,n,r,s,l){if(s){const i=dn(t,n,r,l);e.p(i,s)}}function va(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let r=0;r<n;r++)t[r]=-1;return t}return-1}function fn(e){const t={};for(const n in e)n[0]!=="$"&&(t[n]=e[n]);return t}let ze=!1;function es(){ze=!0}function ts(){ze=!1}function ns(e,t,n,r){for(;e<t;){const s=e+(t-e>>1);n(s)<=r?e=s+1:t=s}return e}function rs(e){if(e.hydrate_init)return;e.hydrate_init=!0;let t=e.childNodes;if(e.nodeName==="HEAD"){const o=[];for(let c=0;c<t.length;c++){const u=t[c];u.claim_order!==void 0&&o.push(u)}t=o}const n=new Int32Array(t.length+1),r=new Int32Array(t.length);n[0]=-1;let s=0;for(let o=0;o<t.length;o++){const c=t[o].claim_order,u=(s>0&&t[n[s]].claim_order<=c?s+1:ns(1,s,_=>t[n[_]].claim_order,c))-1;r[o]=n[u]+1;const f=u+1;n[f]=o,s=Math.max(f,s)}const l=[],i=[];let a=t.length-1;for(let o=n[s]+1;o!=0;o=r[o-1]){for(l.push(t[o-1]);a>=o;a--)i.push(t[a]);a--}for(;a>=0;a--)i.push(t[a]);l.reverse(),i.sort((o,c)=>o.claim_order-c.claim_order);for(let o=0,c=0;o<i.length;o++){for(;c<l.length&&i[o].claim_order>=l[c].claim_order;)c++;const u=c<l.length?l[c]:null;e.insertBefore(i[o],u)}}function En(e,t){if(ze){for(rs(e),(e.actual_end_child===void 0||e.actual_end_child!==null&&e.actual_end_child.parentElement!==e)&&(e.actual_end_child=e.firstChild);e.actual_end_child!==null&&e.actual_end_child.claim_order===void 0;)e.actual_end_child=e.actual_end_child.nextSibling;t!==e.actual_end_child?(t.claim_order!==void 0||t.parentNode!==e)&&e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling}else(t.parentNode!==e||t.nextSibling!==null)&&e.appendChild(t)}function ss(e,t,n){ze&&!n?En(e,t):(t.parentNode!==e||t.nextSibling!=n)&&e.insertBefore(t,n||null)}function mt(e){e.parentNode.removeChild(e)}function wa(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function gt(e){return document.createElement(e)}function ht(e){return document.createTextNode(e)}function Ga(){return ht(" ")}function Fa(){return ht("")}function se(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function _n(e){return Array.from(e.childNodes)}function is(e){e.claim_info===void 0&&(e.claim_info={last_index:0,total_claimed:0})}function pn(e,t,n,r,s=!1){is(e);const l=(()=>{for(let i=e.claim_info.last_index;i<e.length;i++){const a=e[i];if(t(a)){const o=n(a);return o===void 0?e.splice(i,1):e[i]=o,s||(e.claim_info.last_index=i),a}}for(let i=e.claim_info.last_index-1;i>=0;i--){const a=e[i];if(t(a)){const o=n(a);return o===void 0?e.splice(i,1):e[i]=o,s?o===void 0&&e.claim_info.last_index--:e.claim_info.last_index=i,a}}return r()})();return l.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1,l}function ls(e,t,n,r){return pn(e,s=>s.nodeName===t,s=>{const l=[];for(let i=0;i<s.attributes.length;i++){const a=s.attributes[i];n[a.name]||l.push(a.name)}l.forEach(i=>s.removeAttribute(i))},()=>r(t))}function In(e,t,n){return ls(e,t,n,gt)}function os(e,t){return pn(e,n=>n.nodeType===3,n=>{const r=""+t;if(n.data.startsWith(r)){if(n.data.length!==r.length)return n.splitText(r.length)}else n.data=r},()=>ht(t),!0)}function Ba(e){return os(e," ")}function Ua(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}let Xe;function ke(e){Xe=e}function je(){if(!Xe)throw new Error("Function called outside component initialization");return Xe}function Va(e){je().$$.on_mount.push(e)}function as(e){je().$$.after_update.push(e)}function cs(e){je().$$.on_destroy.push(e)}function xa(e,t){je().$$.context.set(e,t)}const Fe=[],Rt=[],Qe=[],Ot=[],us=Promise.resolve();let Dt=!1;function ds(){Dt||(Dt=!0,us.then(x))}function St(e){Qe.push(e)}function qa(e){Ot.push(e)}let yt=!1;const At=new Set;function x(){if(!yt){yt=!0;do{for(let e=0;e<Fe.length;e+=1){const t=Fe[e];ke(t),fs(t.$$)}for(ke(null),Fe.length=0;Rt.length;)Rt.pop()();for(let e=0;e<Qe.length;e+=1){const t=Qe[e];At.has(t)||(At.add(t),t())}Qe.length=0}while(Fe.length);for(;Ot.length;)Ot.pop()();Dt=!1,yt=!1,At.clear()}}function fs(e){if(e.fragment!==null){e.update(),Ge(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(St)}}const $e=new Set;let me;function Ha(){me={r:0,c:[],p:me}}function Ya(){me.r||Ge(me.c),me=me.p}function Es(e,t){e&&e.i&&($e.delete(e),e.i(t))}function Wa(e,t,n,r){if(e&&e.o){if($e.has(e))return;$e.add(e),me.c.push(()=>{$e.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}function za(e,t){const n={},r={},s={$$scope:1};let l=e.length;for(;l--;){const i=e[l],a=t[l];if(a){for(const o in i)o in a||(r[o]=1);for(const o in a)s[o]||(n[o]=a[o],s[o]=1);e[l]=a}else for(const o in i)s[o]=1}for(const i in r)i in n||(n[i]=void 0);return n}function Xa(e){return typeof e=="object"&&e!==null?e:{}}function ka(e,t,n){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function ja(e){e&&e.c()}function Qa(e,t){e&&e.l(t)}function _s(e,t,n,r){const{fragment:s,on_mount:l,on_destroy:i,after_update:a}=e.$$;s&&s.m(t,n),r||St(()=>{const o=l.map(an).filter(Zr);i?i.push(...o):Ge(o),e.$$.on_mount=[]}),a.forEach(St)}function ps(e,t){const n=e.$$;n.fragment!==null&&(Ge(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Is(e,t){e.$$.dirty[0]===-1&&(Fe.push(e),ds(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Ts(e,t,n,r,s,l,i,a=[-1]){const o=Xe;ke(e);const c=e.$$={fragment:null,ctx:null,props:l,update:Te,not_equal:s,bound:cn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:cn(),dirty:a,skip_bound:!1,root:t.target||o.$$.root};i&&i(c.root);let u=!1;if(c.ctx=n?n(e,t.props||{},(f,_,...I)=>{const d=I.length?I[0]:_;return c.ctx&&s(c.ctx[f],c.ctx[f]=d)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](d),u&&Is(e,f)),_}):[],c.update(),u=!0,Ge(c.before_update),c.fragment=r?r(c.ctx):!1,t.target){if(t.hydrate){es();const f=_n(t.target);c.fragment&&c.fragment.l(f),f.forEach(mt)}else c.fragment&&c.fragment.c();t.intro&&Es(e.$$.fragment),_s(e,t.target,t.anchor,t.customElement),ts(),x()}ke(o)}class ms{$destroy(){ps(this,1),this.$destroy=Te}$on(t,n){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(t){this.$$set&&!Jr(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Pe=[];function $a(e,t=Te){let n;const r=new Set;function s(a){if(un(e,a)&&(e=a,n)){const o=!Pe.length;for(const c of r)c[1](),Pe.push(c,e);if(o){for(let c=0;c<Pe.length;c+=2)Pe[c][0](Pe[c+1]);Pe.length=0}}}function l(a){s(a(e))}function i(a,o=Te){const c=[a,o];return r.add(c),r.size===1&&(n=t(s)||Te),a(e),()=>{r.delete(c),r.size===0&&(n(),n=null)}}return{set:s,update:l,subscribe:i}}/*!
 * FilePond 4.30.3
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const gs=e=>e instanceof HTMLElement,hs=(e,t=[],n=[])=>{const r=C({},e),s=[],l=[],i=()=>C({},r),a=()=>{const d=[...s];return s.length=0,d},o=()=>{const d=[...l];l.length=0,d.forEach(({type:T,data:D})=>{c(T,D)})},c=(d,T,D)=>{if(D&&!document.hidden){l.push({type:d,data:T});return}I[d]&&I[d](T),s.push({type:d,data:T})},u=(d,...T)=>_[d]?_[d](...T):null,f={getState:i,processActionQueue:a,processDispatchQueue:o,dispatch:c,query:u};let _={};t.forEach(d=>{_=C(C({},d(r)),_)});let I={};return n.forEach(d=>{I=C(C({},d(c,u,r)),I)}),f},Rs=(e,t,n)=>{if(typeof n=="function"){e[t]=n;return}Object.defineProperty(e,t,C({},n))},H=(e,t)=>{for(const n in e)!e.hasOwnProperty(n)||t(n,e[n])},pe=e=>{const t={};return H(e,n=>{Rs(t,n,e[n])}),t},z=(e,t,n=null)=>{if(n===null)return e.getAttribute(t)||e.hasAttribute(t);e.setAttribute(t,n)},Os="http://www.w3.org/2000/svg",Ds=["svg","path"],Tn=e=>Ds.includes(e),Ke=(e,t,n={})=>{typeof t=="object"&&(n=t,t=null);const r=Tn(e)?document.createElementNS(Os,e):document.createElement(e);return t&&(Tn(e)?z(r,"class",t):r.className=t),H(n,(s,l)=>{z(r,s,l)}),r},Ss=e=>(t,n)=>{typeof n!="undefined"&&e.children[n]?e.insertBefore(t,e.children[n]):e.appendChild(t)},ys=(e,t)=>(n,r)=>(typeof r!="undefined"?t.splice(r,0,n):t.push(n),n),As=(e,t)=>n=>(t.splice(t.indexOf(n),1),n.element.parentNode&&e.removeChild(n.element),n),Ls=(()=>typeof window!="undefined"&&typeof window.document!="undefined")(),mn=()=>Ls,Ps=mn()?Ke("svg"):{},bs="children"in Ps?e=>e.children.length:e=>e.childNodes.length,gn=(e,t,n,r)=>{const s=n[0]||e.left,l=n[1]||e.top,i=s+e.width,a=l+e.height*(r[1]||1),o={element:C({},e),inner:{left:e.left,top:e.top,right:e.right,bottom:e.bottom},outer:{left:s,top:l,right:i,bottom:a}};return t.filter(c=>!c.isRectIgnored()).map(c=>c.rect).forEach(c=>{hn(o.inner,C({},c.inner)),hn(o.outer,C({},c.outer))}),Rn(o.inner),o.outer.bottom+=o.element.marginBottom,o.outer.right+=o.element.marginRight,Rn(o.outer),o},hn=(e,t)=>{t.top+=e.top,t.right+=e.left,t.bottom+=e.top,t.left+=e.left,t.bottom>e.bottom&&(e.bottom=t.bottom),t.right>e.right&&(e.right=t.right)},Rn=e=>{e.width=e.right-e.left,e.height=e.bottom-e.top},ge=e=>typeof e=="number",Ms=(e,t,n,r=.001)=>Math.abs(e-t)<r&&Math.abs(n)<r,Cs=({stiffness:e=.5,damping:t=.75,mass:n=10}={})=>{let r=null,s=null,l=0,i=!1;const c=pe({interpolate:(u,f)=>{if(i)return;if(!(ge(r)&&ge(s))){i=!0,l=0;return}l+=-(s-r)*e/n,s+=l,l*=t,Ms(s,r,l)||f?(s=r,l=0,i=!0,c.onupdate(s),c.oncomplete(s)):c.onupdate(s)},target:{set:u=>{if(ge(u)&&!ge(s)&&(s=u),r===null&&(r=u,s=u),r=u,s===r||typeof r=="undefined"){i=!0,l=0,c.onupdate(s),c.oncomplete(s);return}i=!1},get:()=>r},resting:{get:()=>i},onupdate:u=>{},oncomplete:u=>{}});return c},Ns=e=>e<.5?2*e*e:-1+(4-2*e)*e,vs=({duration:e=500,easing:t=Ns,delay:n=0}={})=>{let r=null,s,l,i=!0,a=!1,o=null;const u=pe({interpolate:(f,_)=>{i||o===null||(r===null&&(r=f),!(f-r<n)&&(s=f-r-n,s>=e||_?(s=1,l=a?0:1,u.onupdate(l*o),u.oncomplete(l*o),i=!0):(l=s/e,u.onupdate((s>=0?t(a?1-l:l):0)*o))))},target:{get:()=>a?0:o,set:f=>{if(o===null){o=f,u.onupdate(f),u.oncomplete(f);return}f<o?(o=1,a=!0):(a=!1,o=f),i=!1,r=null}},resting:{get:()=>i},onupdate:f=>{},oncomplete:f=>{}});return u},On={spring:Cs,tween:vs},ws=(e,t,n)=>{const r=e[t]&&typeof e[t][n]=="object"?e[t][n]:e[t]||e,s=typeof r=="string"?r:r.type,l=typeof r=="object"?C({},r):{};return On[s]?On[s](l):null},Lt=(e,t,n,r=!1)=>{t=Array.isArray(t)?t:[t],t.forEach(s=>{e.forEach(l=>{let i=l,a=()=>n[l],o=c=>n[l]=c;typeof l=="object"&&(i=l.key,a=l.getter||a,o=l.setter||o),!(s[i]&&!r)&&(s[i]={get:a,set:o})})})},Gs=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:r})=>{const s=C({},t),l=[];return H(e,(i,a)=>{const o=ws(a);if(!o)return;o.onupdate=u=>{t[i]=u},o.target=s[i],Lt([{key:i,setter:u=>{o.target!==u&&(o.target=u)},getter:()=>t[i]}],[n,r],t,!0),l.push(o)}),{write:i=>{let a=document.hidden,o=!0;return l.forEach(c=>{c.resting||(o=!1),c.interpolate(i,a)}),o},destroy:()=>{}}},Fs=e=>(t,n)=>{e.addEventListener(t,n)},Bs=e=>(t,n)=>{e.removeEventListener(t,n)},Us=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:r,viewState:s,view:l})=>{const i=[],a=Fs(l.element),o=Bs(l.element);return r.on=(c,u)=>{i.push({type:c,fn:u}),a(c,u)},r.off=(c,u)=>{i.splice(i.findIndex(f=>f.type===c&&f.fn===u),1),o(c,u)},{write:()=>!0,destroy:()=>{i.forEach(c=>{o(c.type,c.fn)})}}},Vs=({mixinConfig:e,viewProps:t,viewExternalAPI:n})=>{Lt(e,n,t)},Z=e=>e!=null,xs={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},qs=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:r,view:s})=>{const l=C({},t),i={};Lt(e,[n,r],t);const a=()=>[t.translateX||0,t.translateY||0],o=()=>[t.scaleX||0,t.scaleY||0],c=()=>s.rect?gn(s.rect,s.childViews,a(),o()):null;return n.rect={get:c},r.rect={get:c},e.forEach(u=>{t[u]=typeof l[u]=="undefined"?xs[u]:l[u]}),{write:()=>{if(!!Hs(i,t))return Ys(s.element,t),Object.assign(i,C({},t)),!0},destroy:()=>{}}},Hs=(e,t)=>{if(Object.keys(e).length!==Object.keys(t).length)return!0;for(const n in t)if(t[n]!==e[n])return!0;return!1},Ys=(e,{opacity:t,perspective:n,translateX:r,translateY:s,scaleX:l,scaleY:i,rotateX:a,rotateY:o,rotateZ:c,originX:u,originY:f,width:_,height:I})=>{let d="",T="";(Z(u)||Z(f))&&(T+=`transform-origin: ${u||0}px ${f||0}px;`),Z(n)&&(d+=`perspective(${n}px) `),(Z(r)||Z(s))&&(d+=`translate3d(${r||0}px, ${s||0}px, 0) `),(Z(l)||Z(i))&&(d+=`scale3d(${Z(l)?l:1}, ${Z(i)?i:1}, 1) `),Z(c)&&(d+=`rotateZ(${c}rad) `),Z(a)&&(d+=`rotateX(${a}rad) `),Z(o)&&(d+=`rotateY(${o}rad) `),d.length&&(T+=`transform:${d};`),Z(t)&&(T+=`opacity:${t};`,t===0&&(T+="visibility:hidden;"),t<1&&(T+="pointer-events:none;")),Z(I)&&(T+=`height:${I}px;`),Z(_)&&(T+=`width:${_}px;`);const D=e.elementCurrentStyle||"";(T.length!==D.length||T!==D)&&(e.style.cssText=T,e.elementCurrentStyle=T)},Ws={styles:qs,listeners:Us,animations:Gs,apis:Vs},Dn=(e={},t={},n={})=>(t.layoutCalculated||(e.paddingTop=parseInt(n.paddingTop,10)||0,e.marginTop=parseInt(n.marginTop,10)||0,e.marginRight=parseInt(n.marginRight,10)||0,e.marginBottom=parseInt(n.marginBottom,10)||0,e.marginLeft=parseInt(n.marginLeft,10)||0,t.layoutCalculated=!0),e.left=t.offsetLeft||0,e.top=t.offsetTop||0,e.width=t.offsetWidth||0,e.height=t.offsetHeight||0,e.right=e.left+e.width,e.bottom=e.top+e.height,e.scrollTop=t.scrollTop,e.hidden=t.offsetParent===null,e),X=({tag:e="div",name:t=null,attributes:n={},read:r=()=>{},write:s=()=>{},create:l=()=>{},destroy:i=()=>{},filterFrameActionsForChild:a=(I,d)=>d,didCreateView:o=()=>{},didWriteView:c=()=>{},ignoreRect:u=!1,ignoreRectUpdate:f=!1,mixins:_=[]}={})=>(I,d={})=>{const T=Ke(e,`filepond--${t}`,n),D=window.getComputedStyle(T,null),h=Dn();let O=null,A=!1;const L=[],y=[],N={},U={},R=[s],b=[r],G=[i],S=()=>T,v=()=>L.concat(),j=()=>N,E=F=>(K,de)=>K(F,de),B=()=>O||(O=gn(h,L,[0,0],[1,1]),O),m=()=>D,g=()=>{O=null,L.forEach(de=>de._read()),!(f&&h.width&&h.height)&&Dn(h,T,D);const K={root:_e,props:d,rect:h};b.forEach(de=>de(K))},M=(F,K,de)=>{let Le=K.length===0;return R.forEach(te=>{te({props:d,root:_e,actions:K,timestamp:F,shouldOptimize:de})===!1&&(Le=!1)}),y.forEach(te=>{te.write(F)===!1&&(Le=!1)}),L.filter(te=>!!te.element.parentNode).forEach(te=>{te._write(F,a(te,K),de)||(Le=!1)}),L.forEach((te,He)=>{te.element.parentNode||(_e.appendChild(te.element,He),te._read(),te._write(F,a(te,K),de),Le=!1)}),A=Le,c({props:d,root:_e,actions:K,timestamp:F}),Le},P=()=>{y.forEach(F=>F.destroy()),G.forEach(F=>{F({root:_e,props:d})}),L.forEach(F=>F._destroy())},V={element:{get:S},style:{get:m},childViews:{get:v}},q=Y(C({},V),{rect:{get:B},ref:{get:j},is:F=>t===F,appendChild:Ss(T),createChildView:E(I),linkView:F=>(L.push(F),F),unlinkView:F=>{L.splice(L.indexOf(F),1)},appendChildView:ys(T,L),removeChildView:As(T,L),registerWriter:F=>R.push(F),registerReader:F=>b.push(F),registerDestroyer:F=>G.push(F),invalidateLayout:()=>T.layoutCalculated=!1,dispatch:I.dispatch,query:I.query}),It={element:{get:S},childViews:{get:v},rect:{get:B},resting:{get:()=>A},isRectIgnored:()=>u,_read:g,_write:M,_destroy:P},kr=Y(C({},V),{rect:{get:()=>h}});Object.keys(_).sort((F,K)=>F==="styles"?1:K==="styles"?-1:0).forEach(F=>{const K=Ws[F]({mixinConfig:_[F],viewProps:d,viewState:U,viewInternalAPI:q,viewExternalAPI:It,view:pe(kr)});K&&y.push(K)});const _e=pe(q);l({root:_e,props:d});const jr=bs(T);return L.forEach((F,K)=>{_e.appendChild(F.element,jr+K)}),o(_e),pe(It)},zs=(e,t,n=60)=>{const r="__framePainter";if(window[r]){window[r].readers.push(e),window[r].writers.push(t);return}window[r]={readers:[e],writers:[t]};const s=window[r],l=1e3/n;let i=null,a=null,o=null,c=null;const u=()=>{document.hidden?(o=()=>window.setTimeout(()=>f(performance.now()),l),c=()=>window.clearTimeout(a)):(o=()=>window.requestAnimationFrame(f),c=()=>window.cancelAnimationFrame(a))};document.addEventListener("visibilitychange",()=>{c&&c(),u(),f(performance.now())});const f=_=>{a=o(f),i||(i=_);const I=_-i;I<=l||(i=_-I%l,s.readers.forEach(d=>d()),s.writers.forEach(d=>d(_)))};return u(),f(performance.now()),{pause:()=>{c(a)}}},J=(e,t)=>({root:n,props:r,actions:s=[],timestamp:l,shouldOptimize:i})=>{s.filter(a=>e[a.type]).forEach(a=>e[a.type]({root:n,props:r,action:a.data,timestamp:l,shouldOptimize:i})),t&&t({root:n,props:r,actions:s,timestamp:l,shouldOptimize:i})},Sn=(e,t)=>t.parentNode.insertBefore(e,t),yn=(e,t)=>t.parentNode.insertBefore(e,t.nextSibling),Ze=e=>Array.isArray(e),fe=e=>e==null,Xs=e=>e.trim(),Je=e=>""+e,ks=(e,t=",")=>fe(e)?[]:Ze(e)?e:Je(e).split(t).map(Xs).filter(n=>n.length),An=e=>typeof e=="boolean",Ln=e=>An(e)?e:e==="true",ee=e=>typeof e=="string",Pn=e=>ge(e)?e:ee(e)?Je(e).replace(/[a-z]+/gi,""):0,et=e=>parseInt(Pn(e),10),bn=e=>parseFloat(Pn(e)),be=e=>ge(e)&&isFinite(e)&&Math.floor(e)===e,Mn=(e,t=1e3)=>{if(be(e))return e;let n=Je(e).trim();return/MB$/i.test(n)?(n=n.replace(/MB$i/,"").trim(),et(n)*t*t):/KB/i.test(n)?(n=n.replace(/KB$i/,"").trim(),et(n)*t):et(n)},he=e=>typeof e=="function",js=e=>{let t=self,n=e.split("."),r=null;for(;r=n.shift();)if(t=t[r],!t)return null;return t},Cn={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},Qs=e=>{const t={};return t.url=ee(e)?e:e.url||"",t.timeout=e.timeout?parseInt(e.timeout,10):0,t.headers=e.headers?e.headers:{},H(Cn,n=>{t[n]=$s(n,e[n],Cn[n],t.timeout,t.headers)}),t.process=e.process||ee(e)||e.url?t.process:null,t.remove=e.remove||null,delete t.headers,t},$s=(e,t,n,r,s)=>{if(t===null)return null;if(typeof t=="function")return t;const l={url:n==="GET"||n==="PATCH"?`?${e}=`:"",method:n,headers:s,withCredentials:!1,timeout:r,onload:null,ondata:null,onerror:null};if(ee(t))return l.url=t,l;if(Object.assign(l,t),ee(l.headers)){const i=l.headers.split(/:(.+)/);l.headers={header:i[0],value:i[1]}}return l.withCredentials=Ln(l.withCredentials),l},Ks=e=>Qs(e),Zs=e=>e===null,Q=e=>typeof e=="object"&&e!==null,Js=e=>Q(e)&&ee(e.url)&&Q(e.process)&&Q(e.revert)&&Q(e.restore)&&Q(e.fetch),Pt=e=>Ze(e)?"array":Zs(e)?"null":be(e)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(e)?"bytes":Js(e)?"api":typeof e,ei=e=>e.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",'),ti={array:ks,boolean:Ln,int:e=>Pt(e)==="bytes"?Mn(e):et(e),number:bn,float:bn,bytes:Mn,string:e=>he(e)?e:Je(e),function:e=>js(e),serverapi:Ks,object:e=>{try{return JSON.parse(ei(e))}catch{return null}}},ni=(e,t)=>ti[t](e),Nn=(e,t,n)=>{if(e===t)return e;let r=Pt(e);if(r!==n){const s=ni(e,n);if(r=Pt(s),s===null)throw`Trying to assign value with incorrect type to "${option}", allowed type: "${n}"`;e=s}return e},ri=(e,t)=>{let n=e;return{enumerable:!0,get:()=>n,set:r=>{n=Nn(r,e,t)}}},si=e=>{const t={};return H(e,n=>{const r=e[n];t[n]=ri(r[0],r[1])}),pe(t)},ii=e=>({items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:si(e)}),tt=(e,t="-")=>e.split(/(?=[A-Z])/).map(n=>n.toLowerCase()).join(t),li=(e,t)=>{const n={};return H(t,r=>{n[r]={get:()=>e.getState().options[r],set:s=>{e.dispatch(`SET_${tt(r,"_").toUpperCase()}`,{value:s})}}}),n},oi=e=>(t,n,r)=>{const s={};return H(e,l=>{const i=tt(l,"_").toUpperCase();s[`SET_${i}`]=a=>{try{r.options[l]=a.value}catch{}t(`DID_SET_${i}`,{value:r.options[l]})}}),s},ai=e=>t=>{const n={};return H(e,r=>{n[`GET_${tt(r,"_").toUpperCase()}`]=s=>t.options[r]}),n},ie={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5},bt=()=>Math.random().toString(36).substr(2,9),Mt=(e,t)=>e.splice(t,1),ci=(e,t)=>{t?e():document.hidden?Promise.resolve(1).then(e):setTimeout(e,0)},nt=()=>{const e=[],t=(r,s)=>{Mt(e,e.findIndex(l=>l.event===r&&(l.cb===s||!s)))},n=(r,s,l)=>{e.filter(i=>i.event===r).map(i=>i.cb).forEach(i=>ci(()=>i(...s),l))};return{fireSync:(r,...s)=>{n(r,s,!0)},fire:(r,...s)=>{n(r,s,!1)},on:(r,s)=>{e.push({event:r,cb:s})},onOnce:(r,s)=>{e.push({event:r,cb:(...l)=>{t(r,s),s(...l)}})},off:t}},vn=(e,t,n)=>{Object.getOwnPropertyNames(e).filter(r=>!n.includes(r)).forEach(r=>Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r)))},ui=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"],ne=e=>{const t={};return vn(e,t,ui),t},di=e=>{e.forEach((t,n)=>{t.released&&Mt(e,n)})},w={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},$={INPUT:1,LIMBO:2,LOCAL:3},wn=e=>/[^0-9]+/.exec(e),Gn=()=>wn(1.1 .toLocaleString())[0],fi=()=>{const e=Gn(),t=1e3 .toLocaleString(),n=1e3 .toString();return t!==n?wn(t)[0]:e==="."?",":"."},p={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},Ct=[],ae=(e,t,n)=>new Promise((r,s)=>{const l=Ct.filter(a=>a.key===e).map(a=>a.cb);if(l.length===0){r(t);return}const i=l.shift();l.reduce((a,o)=>a.then(c=>o(c,n)),i(t,n)).then(a=>r(a)).catch(a=>s(a))}),Re=(e,t,n)=>Ct.filter(r=>r.key===e).map(r=>r.cb(t,n)),Ei=(e,t)=>Ct.push({key:e,cb:t}),_i=e=>Object.assign(Me,e),rt=()=>C({},Me),pi=e=>{H(e,(t,n)=>{!Me[t]||(Me[t][0]=Nn(n,Me[t][0],Me[t][1]))})},Me={id:[null,p.STRING],name:["filepond",p.STRING],disabled:[!1,p.BOOLEAN],className:[null,p.STRING],required:[!1,p.BOOLEAN],captureMethod:[null,p.STRING],allowSyncAcceptAttribute:[!0,p.BOOLEAN],allowDrop:[!0,p.BOOLEAN],allowBrowse:[!0,p.BOOLEAN],allowPaste:[!0,p.BOOLEAN],allowMultiple:[!1,p.BOOLEAN],allowReplace:[!0,p.BOOLEAN],allowRevert:[!0,p.BOOLEAN],allowRemove:[!0,p.BOOLEAN],allowProcess:[!0,p.BOOLEAN],allowReorder:[!1,p.BOOLEAN],allowDirectoriesOnly:[!1,p.BOOLEAN],storeAsFile:[!1,p.BOOLEAN],forceRevert:[!1,p.BOOLEAN],maxFiles:[null,p.INT],checkValidity:[!1,p.BOOLEAN],itemInsertLocationFreedom:[!0,p.BOOLEAN],itemInsertLocation:["before",p.STRING],itemInsertInterval:[75,p.INT],dropOnPage:[!1,p.BOOLEAN],dropOnElement:[!0,p.BOOLEAN],dropValidation:[!1,p.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],p.ARRAY],instantUpload:[!0,p.BOOLEAN],maxParallelUploads:[2,p.INT],allowMinimumUploadDuration:[!0,p.BOOLEAN],chunkUploads:[!1,p.BOOLEAN],chunkForce:[!1,p.BOOLEAN],chunkSize:[5e6,p.INT],chunkRetryDelays:[[500,1e3,3e3],p.ARRAY],server:[null,p.SERVER_API],fileSizeBase:[1e3,p.INT],labelFileSizeBytes:["bytes",p.STRING],labelFileSizeKilobytes:["KB",p.STRING],labelFileSizeMegabytes:["MB",p.STRING],labelFileSizeGigabytes:["GB",p.STRING],labelDecimalSeparator:[Gn(),p.STRING],labelThousandsSeparator:[fi(),p.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',p.STRING],labelInvalidField:["Field contains invalid files",p.STRING],labelFileWaitingForSize:["Waiting for size",p.STRING],labelFileSizeNotAvailable:["Size not available",p.STRING],labelFileCountSingular:["file in list",p.STRING],labelFileCountPlural:["files in list",p.STRING],labelFileLoading:["Loading",p.STRING],labelFileAdded:["Added",p.STRING],labelFileLoadError:["Error during load",p.STRING],labelFileRemoved:["Removed",p.STRING],labelFileRemoveError:["Error during remove",p.STRING],labelFileProcessing:["Uploading",p.STRING],labelFileProcessingComplete:["Upload complete",p.STRING],labelFileProcessingAborted:["Upload cancelled",p.STRING],labelFileProcessingError:["Error during upload",p.STRING],labelFileProcessingRevertError:["Error during revert",p.STRING],labelTapToCancel:["tap to cancel",p.STRING],labelTapToRetry:["tap to retry",p.STRING],labelTapToUndo:["tap to undo",p.STRING],labelButtonRemoveItem:["Remove",p.STRING],labelButtonAbortItemLoad:["Abort",p.STRING],labelButtonRetryItemLoad:["Retry",p.STRING],labelButtonAbortItemProcessing:["Cancel",p.STRING],labelButtonUndoItemProcessing:["Undo",p.STRING],labelButtonRetryItemProcessing:["Retry",p.STRING],labelButtonProcessItem:["Upload",p.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',p.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',p.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',p.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',p.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',p.STRING],oninit:[null,p.FUNCTION],onwarning:[null,p.FUNCTION],onerror:[null,p.FUNCTION],onactivatefile:[null,p.FUNCTION],oninitfile:[null,p.FUNCTION],onaddfilestart:[null,p.FUNCTION],onaddfileprogress:[null,p.FUNCTION],onaddfile:[null,p.FUNCTION],onprocessfilestart:[null,p.FUNCTION],onprocessfileprogress:[null,p.FUNCTION],onprocessfileabort:[null,p.FUNCTION],onprocessfilerevert:[null,p.FUNCTION],onprocessfile:[null,p.FUNCTION],onprocessfiles:[null,p.FUNCTION],onremovefile:[null,p.FUNCTION],onpreparefile:[null,p.FUNCTION],onupdatefiles:[null,p.FUNCTION],onreorderfiles:[null,p.FUNCTION],beforeDropFile:[null,p.FUNCTION],beforeAddFile:[null,p.FUNCTION],beforeRemoveFile:[null,p.FUNCTION],beforePrepareFile:[null,p.FUNCTION],stylePanelLayout:[null,p.STRING],stylePanelAspectRatio:[null,p.STRING],styleItemPanelAspectRatio:[null,p.STRING],styleButtonRemoveItemPosition:["left",p.STRING],styleButtonProcessItemPosition:["right",p.STRING],styleLoadIndicatorPosition:["right",p.STRING],styleProgressIndicatorPosition:["right",p.STRING],styleButtonRemoveItemAlign:[!1,p.BOOLEAN],files:[[],p.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],p.ARRAY]},Oe=(e,t)=>fe(t)?e[0]||null:be(t)?e[t]||null:(typeof t=="object"&&(t=t.id),e.find(n=>n.id===t)||null),Fn=e=>{if(fe(e))return e;if(/:/.test(e)){const t=e.split(":");return t[1]/t[0]}return parseFloat(e)},ce=e=>e.filter(t=>!t.archived),Ii={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4};let st=null;const Ti=()=>{if(st===null)try{const e=new DataTransfer;e.items.add(new File(["hello world"],"This_Works.txt"));const t=document.createElement("input");t.setAttribute("type","file"),t.files=e.files,st=t.files.length===1}catch{st=!1}return st},mi=[w.LOAD_ERROR,w.PROCESSING_ERROR,w.PROCESSING_REVERT_ERROR],gi=[w.LOADING,w.PROCESSING,w.PROCESSING_QUEUED,w.INIT],hi=[w.PROCESSING_COMPLETE],Ri=e=>mi.includes(e.status),Oi=e=>gi.includes(e.status),Di=e=>hi.includes(e.status),Bn=e=>Q(e.options.server)&&(Q(e.options.server.process)||he(e.options.server.process)),Si=e=>({GET_STATUS:()=>{const t=ce(e.items),{EMPTY:n,ERROR:r,BUSY:s,IDLE:l,READY:i}=Ii;return t.length===0?n:t.some(Ri)?r:t.some(Oi)?s:t.some(Di)?i:l},GET_ITEM:t=>Oe(e.items,t),GET_ACTIVE_ITEM:t=>Oe(ce(e.items),t),GET_ACTIVE_ITEMS:()=>ce(e.items),GET_ITEMS:()=>e.items,GET_ITEM_NAME:t=>{const n=Oe(e.items,t);return n?n.filename:null},GET_ITEM_SIZE:t=>{const n=Oe(e.items,t);return n?n.fileSize:null},GET_STYLES:()=>Object.keys(e.options).filter(t=>/^style/.test(t)).map(t=>({name:t,value:e.options[t]})),GET_PANEL_ASPECT_RATIO:()=>/circle/.test(e.options.stylePanelLayout)?1:Fn(e.options.stylePanelAspectRatio),GET_ITEM_PANEL_ASPECT_RATIO:()=>e.options.styleItemPanelAspectRatio,GET_ITEMS_BY_STATUS:t=>ce(e.items).filter(n=>n.status===t),GET_TOTAL_ITEMS:()=>ce(e.items).length,SHOULD_UPDATE_FILE_INPUT:()=>e.options.storeAsFile&&Ti()&&!Bn(e),IS_ASYNC:()=>Bn(e),GET_FILE_SIZE_LABELS:t=>({labelBytes:t("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:t("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:t("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:t("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0})}),yi=e=>{const t=ce(e.items).length;if(!e.options.allowMultiple)return t===0;const n=e.options.maxFiles;return n===null||t<n},Un=(e,t,n)=>Math.max(Math.min(n,e),t),Ai=(e,t,n)=>e.splice(t,0,n),Li=(e,t,n)=>fe(t)?null:typeof n=="undefined"?(e.push(t),t):(n=Un(n,0,e.length),Ai(e,n,t),t),Nt=e=>/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(e),Be=e=>e.split("/").pop().split("?").shift(),it=e=>e.split(".").pop(),Pi=e=>{if(typeof e!="string")return"";const t=e.split("/").pop();return/svg/.test(t)?"svg":/zip|compressed/.test(t)?"zip":/plain/.test(t)?"txt":/msword/.test(t)?"doc":/[a-z]+/.test(t)?t==="jpeg"?"jpg":t:""},Ue=(e,t="")=>(t+e).slice(-t.length),Vn=(e=new Date)=>`${e.getFullYear()}-${Ue(e.getMonth()+1,"00")}-${Ue(e.getDate(),"00")}_${Ue(e.getHours(),"00")}-${Ue(e.getMinutes(),"00")}-${Ue(e.getSeconds(),"00")}`,Ce=(e,t,n=null,r=null)=>{const s=typeof n=="string"?e.slice(0,e.size,n):e.slice(0,e.size,e.type);return s.lastModifiedDate=new Date,e._relativePath&&(s._relativePath=e._relativePath),ee(t)||(t=Vn()),t&&r===null&&it(t)?s.name=t:(r=r||Pi(s.type),s.name=t+(r?"."+r:"")),s},bi=()=>window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,xn=(e,t)=>{const n=bi();if(n){const r=new n;return r.append(e),r.getBlob(t)}return new Blob([e],{type:t})},Mi=(e,t)=>{const n=new ArrayBuffer(e.length),r=new Uint8Array(n);for(let s=0;s<e.length;s++)r[s]=e.charCodeAt(s);return xn(n,t)},qn=e=>(/^data:(.+);/.exec(e)||[])[1]||null,Ci=e=>e.split(",")[1].replace(/\s/g,""),Ni=e=>atob(Ci(e)),vi=e=>{const t=qn(e),n=Ni(e);return Mi(n,t)},wi=(e,t,n)=>Ce(vi(e),t,null,n),Gi=e=>{if(!/^content-disposition:/i.test(e))return null;const t=e.split(/filename=|filename\*=.+''/).splice(1).map(n=>n.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(n=>n.length);return t.length?decodeURI(t[t.length-1]):null},Fi=e=>{if(/content-length:/i.test(e)){const t=e.match(/[0-9]+/)[0];return t?parseInt(t,10):null}return null},Bi=e=>/x-content-transfer-id:/i.test(e)&&(e.split(":")[1]||"").trim()||null,vt=e=>{const t={source:null,name:null,size:null},n=e.split(`
`);for(let r of n){const s=Gi(r);if(s){t.name=s;continue}const l=Fi(r);if(l){t.size=l;continue}const i=Bi(r);if(i){t.source=i;continue}}return t},Ui=e=>{const t={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},n=()=>t.progress,r=()=>{t.request&&t.request.abort&&t.request.abort()},s=()=>{const a=t.source;i.fire("init",a),a instanceof File?i.fire("load",a):a instanceof Blob?i.fire("load",Ce(a,a.name)):Nt(a)?i.fire("load",wi(a)):l(a)},l=a=>{if(!e){i.fire("error",{type:"error",body:"Can't load URL",code:400});return}t.timestamp=Date.now(),t.request=e(a,o=>{t.duration=Date.now()-t.timestamp,t.complete=!0,o instanceof Blob&&(o=Ce(o,o.name||Be(a))),i.fire("load",o instanceof Blob?o:o?o.body:null)},o=>{i.fire("error",typeof o=="string"?{type:"error",code:0,body:o}:o)},(o,c,u)=>{if(u&&(t.size=u),t.duration=Date.now()-t.timestamp,!o){t.progress=null;return}t.progress=c/u,i.fire("progress",t.progress)},()=>{i.fire("abort")},o=>{const c=vt(typeof o=="string"?o:o.headers);i.fire("meta",{size:t.size||c.size,filename:c.name,source:c.source})})},i=Y(C({},nt()),{setSource:a=>t.source=a,getProgress:n,abort:r,load:s});return i},Hn=e=>/GET|HEAD/.test(e),De=(e,t,n)=>{const r={onheaders:()=>{},onprogress:()=>{},onload:()=>{},ontimeout:()=>{},onerror:()=>{},onabort:()=>{},abort:()=>{s=!0,i.abort()}};let s=!1,l=!1;n=C({method:"POST",headers:{},withCredentials:!1},n),t=encodeURI(t),Hn(n.method)&&e&&(t=`${t}${encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))}`);const i=new XMLHttpRequest,a=Hn(n.method)?i:i.upload;return a.onprogress=o=>{s||r.onprogress(o.lengthComputable,o.loaded,o.total)},i.onreadystatechange=()=>{i.readyState<2||i.readyState===4&&i.status===0||l||(l=!0,r.onheaders(i))},i.onload=()=>{i.status>=200&&i.status<300?r.onload(i):r.onerror(i)},i.onerror=()=>r.onerror(i),i.onabort=()=>{s=!0,r.onabort()},i.ontimeout=()=>r.ontimeout(i),i.open(n.method,t,!0),be(n.timeout)&&(i.timeout=n.timeout),Object.keys(n.headers).forEach(o=>{const c=unescape(encodeURIComponent(n.headers[o]));i.setRequestHeader(o,c)}),n.responseType&&(i.responseType=n.responseType),n.withCredentials&&(i.withCredentials=!0),i.send(e),r},k=(e,t,n,r)=>({type:e,code:t,body:n,headers:r}),Se=e=>t=>{e(k("error",0,"Timeout",t.getAllResponseHeaders()))},Yn=e=>/\?/.test(e),Ve=(...e)=>{let t="";return e.forEach(n=>{t+=Yn(t)&&Yn(n)?n.replace(/\?/,"&"):n}),t},wt=(e="",t)=>{if(typeof t=="function")return t;if(!t||!ee(t.url))return null;const n=t.onload||(s=>s),r=t.onerror||(s=>null);return(s,l,i,a,o,c)=>{const u=De(s,Ve(e,t.url),Y(C({},t),{responseType:"blob"}));return u.onload=f=>{const _=f.getAllResponseHeaders(),I=vt(_).name||Be(s);l(k("load",f.status,t.method==="HEAD"?null:Ce(n(f.response),I),_))},u.onerror=f=>{i(k("error",f.status,r(f.response)||f.statusText,f.getAllResponseHeaders()))},u.onheaders=f=>{c(k("headers",f.status,null,f.getAllResponseHeaders()))},u.ontimeout=Se(i),u.onprogress=a,u.onabort=o,u}},le={QUEUED:0,COMPLETE:1,PROCESSING:2,ERROR:3,WAITING:4},Vi=(e,t,n,r,s,l,i,a,o,c,u)=>{const f=[],{chunkTransferId:_,chunkServer:I,chunkSize:d,chunkRetryDelays:T}=u,D={serverId:_,aborted:!1},h=t.ondata||(E=>E),O=t.onload||((E,B)=>B==="HEAD"?E.getResponseHeader("Upload-Offset"):E.response),A=t.onerror||(E=>null),L=E=>{const B=new FormData;Q(s)&&B.append(n,JSON.stringify(s));const m=typeof t.headers=="function"?t.headers(r,s):Y(C({},t.headers),{"Upload-Length":r.size}),g=Y(C({},t),{headers:m}),M=De(h(B),Ve(e,t.url),g);M.onload=P=>E(O(P,g.method)),M.onerror=P=>i(k("error",P.status,A(P.response)||P.statusText,P.getAllResponseHeaders())),M.ontimeout=Se(i)},y=E=>{const B=Ve(e,I.url,D.serverId),g={headers:typeof t.headers=="function"?t.headers(D.serverId):C({},t.headers),method:"HEAD"},M=De(null,B,g);M.onload=P=>E(O(P,g.method)),M.onerror=P=>i(k("error",P.status,A(P.response)||P.statusText,P.getAllResponseHeaders())),M.ontimeout=Se(i)},N=Math.floor(r.size/d);for(let E=0;E<=N;E++){const B=E*d,m=r.slice(B,B+d,"application/offset+octet-stream");f[E]={index:E,size:m.size,offset:B,data:m,file:r,progress:0,retries:[...T],status:le.QUEUED,error:null,request:null,timeout:null}}const U=()=>l(D.serverId),R=E=>E.status===le.QUEUED||E.status===le.ERROR,b=E=>{if(D.aborted)return;if(E=E||f.find(R),!E){f.every(V=>V.status===le.COMPLETE)&&U();return}E.status=le.PROCESSING,E.progress=null;const B=I.ondata||(V=>V),m=I.onerror||(V=>null),g=Ve(e,I.url,D.serverId),M=typeof I.headers=="function"?I.headers(E):Y(C({},I.headers),{"Content-Type":"application/offset+octet-stream","Upload-Offset":E.offset,"Upload-Length":r.size,"Upload-Name":r.name}),P=E.request=De(B(E.data),g,Y(C({},I),{headers:M}));P.onload=()=>{E.status=le.COMPLETE,E.request=null,v()},P.onprogress=(V,q,It)=>{E.progress=V?q:null,S()},P.onerror=V=>{E.status=le.ERROR,E.request=null,E.error=m(V.response)||V.statusText,G(E)||i(k("error",V.status,m(V.response)||V.statusText,V.getAllResponseHeaders()))},P.ontimeout=V=>{E.status=le.ERROR,E.request=null,G(E)||Se(i)(V)},P.onabort=()=>{E.status=le.QUEUED,E.request=null,o()}},G=E=>E.retries.length===0?!1:(E.status=le.WAITING,clearTimeout(E.timeout),E.timeout=setTimeout(()=>{b(E)},E.retries.shift()),!0),S=()=>{const E=f.reduce((m,g)=>m===null||g.progress===null?null:m+g.progress,0);if(E===null)return a(!1,0,0);const B=f.reduce((m,g)=>m+g.size,0);a(!0,E,B)},v=()=>{f.filter(B=>B.status===le.PROCESSING).length>=1||b()},j=()=>{f.forEach(E=>{clearTimeout(E.timeout),E.request&&E.request.abort()})};return D.serverId?y(E=>{D.aborted||(f.filter(B=>B.offset<E).forEach(B=>{B.status=le.COMPLETE,B.progress=B.size}),v())}):L(E=>{D.aborted||(c(E),D.serverId=E,v())}),{abort:()=>{D.aborted=!0,j()}}},xi=(e,t,n,r)=>(s,l,i,a,o,c,u)=>{if(!s)return;const f=r.chunkUploads,_=f&&s.size>r.chunkSize,I=f&&(_||r.chunkForce);if(s instanceof Blob&&I)return Vi(e,t,n,s,l,i,a,o,c,u,r);const d=t.ondata||(y=>y),T=t.onload||(y=>y),D=t.onerror||(y=>null),h=typeof t.headers=="function"?t.headers(s,l)||{}:C({},t.headers),O=Y(C({},t),{headers:h});var A=new FormData;Q(l)&&A.append(n,JSON.stringify(l)),(s instanceof Blob?[{name:null,file:s}]:s).forEach(y=>{A.append(n,y.file,y.name===null?y.file.name:`${y.name}${y.file.name}`)});const L=De(d(A),Ve(e,t.url),O);return L.onload=y=>{i(k("load",y.status,T(y.response),y.getAllResponseHeaders()))},L.onerror=y=>{a(k("error",y.status,D(y.response)||y.statusText,y.getAllResponseHeaders()))},L.ontimeout=Se(a),L.onprogress=o,L.onabort=c,L},qi=(e="",t,n,r)=>typeof t=="function"?(...s)=>t(n,...s,r):!t||!ee(t.url)?null:xi(e,t,n,r),xe=(e="",t)=>{if(typeof t=="function")return t;if(!t||!ee(t.url))return(s,l)=>l();const n=t.onload||(s=>s),r=t.onerror||(s=>null);return(s,l,i)=>{const a=De(s,e+t.url,t);return a.onload=o=>{l(k("load",o.status,n(o.response),o.getAllResponseHeaders()))},a.onerror=o=>{i(k("error",o.status,r(o.response)||o.statusText,o.getAllResponseHeaders()))},a.ontimeout=Se(i),a}},Wn=(e=0,t=1)=>e+Math.random()*(t-e),Hi=(e,t=1e3,n=0,r=25,s=250)=>{let l=null;const i=Date.now(),a=()=>{let o=Date.now()-i,c=Wn(r,s);o+c>t&&(c=o+c-t);let u=o/t;if(u>=1||document.hidden){e(1);return}e(u),l=setTimeout(a,c)};return t>0&&a(),{clear:()=>{clearTimeout(l)}}},Yi=(e,t)=>{const n={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},{allowMinimumUploadDuration:r}=t,s=(u,f)=>{const _=()=>{n.duration===0||n.progress===null||c.fire("progress",c.getProgress())},I=()=>{n.complete=!0,c.fire("load-perceived",n.response.body)};c.fire("start"),n.timestamp=Date.now(),n.perceivedPerformanceUpdater=Hi(d=>{n.perceivedProgress=d,n.perceivedDuration=Date.now()-n.timestamp,_(),n.response&&n.perceivedProgress===1&&!n.complete&&I()},r?Wn(750,1500):0),n.request=e(u,f,d=>{n.response=Q(d)?d:{type:"load",code:200,body:`${d}`,headers:{}},n.duration=Date.now()-n.timestamp,n.progress=1,c.fire("load",n.response.body),(!r||r&&n.perceivedProgress===1)&&I()},d=>{n.perceivedPerformanceUpdater.clear(),c.fire("error",Q(d)?d:{type:"error",code:0,body:`${d}`})},(d,T,D)=>{n.duration=Date.now()-n.timestamp,n.progress=d?T/D:null,_()},()=>{n.perceivedPerformanceUpdater.clear(),c.fire("abort",n.response?n.response.body:null)},d=>{c.fire("transfer",d)})},l=()=>{!n.request||(n.perceivedPerformanceUpdater.clear(),n.request.abort&&n.request.abort(),n.complete=!0)},i=()=>{l(),n.complete=!1,n.perceivedProgress=0,n.progress=0,n.timestamp=null,n.perceivedDuration=0,n.duration=0,n.request=null,n.response=null},a=r?()=>n.progress?Math.min(n.progress,n.perceivedProgress):null:()=>n.progress||null,o=r?()=>Math.min(n.duration,n.perceivedDuration):()=>n.duration,c=Y(C({},nt()),{process:s,abort:l,getProgress:a,getDuration:o,reset:i});return c},zn=e=>e.substr(0,e.lastIndexOf("."))||e,Wi=e=>{let t=[e.name,e.size,e.type];return e instanceof Blob||Nt(e)?t[0]=e.name||Vn():Nt(e)?(t[1]=e.length,t[2]=qn(e)):ee(e)&&(t[0]=Be(e),t[1]=0,t[2]="application/octet-stream"),{name:t[0],size:t[1],type:t[2]}},Ne=e=>!!(e instanceof File||e instanceof Blob&&e.name),Xn=e=>{if(!Q(e))return e;const t=Ze(e)?[]:{};for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n];t[n]=r&&Q(r)?Xn(r):r}return t},zi=(e=null,t=null,n=null)=>{const r=bt(),s={archived:!1,frozen:!1,released:!1,source:null,file:n,serverFileReference:t,transferId:null,processingAborted:!1,status:t?w.PROCESSING_COMPLETE:w.INIT,activeLoader:null,activeProcessor:null};let l=null;const i={},a=R=>s.status=R,o=(R,...b)=>{s.released||s.frozen||N.fire(R,...b)},c=()=>it(s.file.name),u=()=>s.file.type,f=()=>s.file.size,_=()=>s.file,I=(R,b,G)=>{if(s.source=R,N.fireSync("init"),s.file){N.fireSync("load-skip");return}s.file=Wi(R),b.on("init",()=>{o("load-init")}),b.on("meta",S=>{s.file.size=S.size,s.file.filename=S.filename,S.source&&(e=$.LIMBO,s.serverFileReference=S.source,s.status=w.PROCESSING_COMPLETE),o("load-meta")}),b.on("progress",S=>{a(w.LOADING),o("load-progress",S)}),b.on("error",S=>{a(w.LOAD_ERROR),o("load-request-error",S)}),b.on("abort",()=>{a(w.INIT),o("load-abort")}),b.on("load",S=>{s.activeLoader=null;const v=E=>{s.file=Ne(E)?E:s.file,e===$.LIMBO&&s.serverFileReference?a(w.PROCESSING_COMPLETE):a(w.IDLE),o("load")},j=E=>{s.file=S,o("load-meta"),a(w.LOAD_ERROR),o("load-file-error",E)};if(s.serverFileReference){v(S);return}G(S,v,j)}),b.setSource(R),s.activeLoader=b,b.load()},d=()=>{!s.activeLoader||s.activeLoader.load()},T=()=>{if(s.activeLoader){s.activeLoader.abort();return}a(w.INIT),o("load-abort")},D=(R,b)=>{if(s.processingAborted){s.processingAborted=!1;return}if(a(w.PROCESSING),l=null,!(s.file instanceof Blob)){N.on("load",()=>{D(R,b)});return}R.on("load",v=>{s.transferId=null,s.serverFileReference=v}),R.on("transfer",v=>{s.transferId=v}),R.on("load-perceived",v=>{s.activeProcessor=null,s.transferId=null,s.serverFileReference=v,a(w.PROCESSING_COMPLETE),o("process-complete",v)}),R.on("start",()=>{o("process-start")}),R.on("error",v=>{s.activeProcessor=null,a(w.PROCESSING_ERROR),o("process-error",v)}),R.on("abort",v=>{s.activeProcessor=null,s.serverFileReference=v,a(w.IDLE),o("process-abort"),l&&l()}),R.on("progress",v=>{o("process-progress",v)});const G=v=>{s.archived||R.process(v,C({},i))},S=console.error;b(s.file,G,S),s.activeProcessor=R},h=()=>{s.processingAborted=!1,a(w.PROCESSING_QUEUED)},O=()=>new Promise(R=>{if(!s.activeProcessor){s.processingAborted=!0,a(w.IDLE),o("process-abort"),R();return}l=()=>{R()},s.activeProcessor.abort()}),A=(R,b)=>new Promise((G,S)=>{const v=s.serverFileReference!==null?s.serverFileReference:s.transferId;if(v===null){G();return}R(v,()=>{s.serverFileReference=null,s.transferId=null,G()},j=>{if(!b){G();return}a(w.PROCESSING_REVERT_ERROR),o("process-revert-error"),S(j)}),a(w.IDLE),o("process-revert")}),L=(R,b,G)=>{const S=R.split("."),v=S[0],j=S.pop();let E=i;S.forEach(B=>E=E[B]),JSON.stringify(E[j])!==JSON.stringify(b)&&(E[j]=b,o("metadata-update",{key:v,value:i[v],silent:G}))},N=Y(C({id:{get:()=>r},origin:{get:()=>e,set:R=>e=R},serverId:{get:()=>s.serverFileReference},transferId:{get:()=>s.transferId},status:{get:()=>s.status},filename:{get:()=>s.file.name},filenameWithoutExtension:{get:()=>zn(s.file.name)},fileExtension:{get:c},fileType:{get:u},fileSize:{get:f},file:{get:_},relativePath:{get:()=>s.file._relativePath},source:{get:()=>s.source},getMetadata:R=>Xn(R?i[R]:i),setMetadata:(R,b,G)=>{if(Q(R)){const S=R;return Object.keys(S).forEach(v=>{L(v,S[v],b)}),R}return L(R,b,G),b},extend:(R,b)=>U[R]=b,abortLoad:T,retryLoad:d,requestProcessing:h,abortProcessing:O,load:I,process:D,revert:A},nt()),{freeze:()=>s.frozen=!0,release:()=>s.released=!0,released:{get:()=>s.released},archive:()=>s.archived=!0,archived:{get:()=>s.archived}}),U=pe(N);return U},Xi=(e,t)=>fe(t)?0:ee(t)?e.findIndex(n=>n.id===t):-1,kn=(e,t)=>{const n=Xi(e,t);if(!(n<0))return e[n]||null},jn=(e,t,n,r,s,l)=>{const i=De(null,e,{method:"GET",responseType:"blob"});return i.onload=a=>{const o=a.getAllResponseHeaders(),c=vt(o).name||Be(e);t(k("load",a.status,Ce(a.response,c),o))},i.onerror=a=>{n(k("error",a.status,a.statusText,a.getAllResponseHeaders()))},i.onheaders=a=>{l(k("headers",a.status,null,a.getAllResponseHeaders()))},i.ontimeout=Se(n),i.onprogress=r,i.onabort=s,i},Qn=e=>(e.indexOf("//")===0&&(e=location.protocol+e),e.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]),ki=e=>(e.indexOf(":")>-1||e.indexOf("//")>-1)&&Qn(location.href)!==Qn(e),lt=e=>(...t)=>he(e)?e(...t):e,ji=e=>!Ne(e.file),Gt=(e,t)=>{clearTimeout(t.listUpdateTimeout),t.listUpdateTimeout=setTimeout(()=>{e("DID_UPDATE_ITEMS",{items:ce(t.items)})},0)},$n=(e,...t)=>new Promise(n=>{if(!e)return n(!0);const r=e(...t);if(r==null)return n(!0);if(typeof r=="boolean")return n(r);typeof r.then=="function"&&r.then(n)}),Ft=(e,t)=>{e.items.sort((n,r)=>t(ne(n),ne(r)))},oe=(e,t)=>(i={})=>{var a=i,{query:n,success:r=()=>{},failure:s=()=>{}}=a,l=on(a,["query","success","failure"]);const o=Oe(e.items,n);if(!o){s({error:k("error",0,"Item not found"),file:null});return}t(o,r,s,l||{})},Qi=(e,t,n)=>({ABORT_ALL:()=>{ce(n.items).forEach(r=>{r.freeze(),r.abortLoad(),r.abortProcessing()})},DID_SET_FILES:({value:r=[]})=>{const s=r.map(i=>({source:i.source?i.source:i,options:i.options}));let l=ce(n.items);l.forEach(i=>{s.find(a=>a.source===i.source||a.source===i.file)||e("REMOVE_ITEM",{query:i,remove:!1})}),l=ce(n.items),s.forEach((i,a)=>{l.find(o=>o.source===i.source||o.file===i.source)||e("ADD_ITEM",Y(C({},i),{interactionMethod:ie.NONE,index:a}))})},DID_UPDATE_ITEM_METADATA:({id:r,action:s,change:l})=>{l.silent||(clearTimeout(n.itemUpdateTimeout),n.itemUpdateTimeout=setTimeout(()=>{const i=kn(n.items,r);if(!t("IS_ASYNC")){ae("SHOULD_PREPARE_OUTPUT",!1,{item:i,query:t,action:s,change:l}).then(u=>{const f=t("GET_BEFORE_PREPARE_FILE");f&&(u=f(i,u)),!!u&&e("REQUEST_PREPARE_OUTPUT",{query:r,item:i,success:_=>{e("DID_PREPARE_OUTPUT",{id:r,file:_})}},!0)});return}i.origin===$.LOCAL&&e("DID_LOAD_ITEM",{id:i.id,error:null,serverFileReference:i.source});const a=()=>{setTimeout(()=>{e("REQUEST_ITEM_PROCESSING",{query:r})},32)},o=u=>{i.revert(xe(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(u?a:()=>{}).catch(()=>{})},c=u=>{i.abortProcessing().then(u?a:()=>{})};if(i.status===w.PROCESSING_COMPLETE)return o(n.options.instantUpload);if(i.status===w.PROCESSING)return c(n.options.instantUpload);n.options.instantUpload&&a()},0))},MOVE_ITEM:({query:r,index:s})=>{const l=Oe(n.items,r);if(!l)return;const i=n.items.indexOf(l);s=Un(s,0,n.items.length-1),i!==s&&n.items.splice(s,0,n.items.splice(i,1)[0])},SORT:({compare:r})=>{Ft(n,r),e("DID_SORT_ITEMS",{items:t("GET_ACTIVE_ITEMS")})},ADD_ITEMS:({items:r,index:s,interactionMethod:l,success:i=()=>{},failure:a=()=>{}})=>{let o=s;if(s===-1||typeof s=="undefined"){const I=t("GET_ITEM_INSERT_LOCATION"),d=t("GET_TOTAL_ITEMS");o=I==="before"?0:d}const c=t("GET_IGNORED_FILES"),u=I=>Ne(I)?!c.includes(I.name.toLowerCase()):!fe(I),_=r.filter(u).map(I=>new Promise((d,T)=>{e("ADD_ITEM",{interactionMethod:l,source:I.source||I,success:d,failure:T,index:o++,options:I.options||{}})}));Promise.all(_).then(i).catch(a)},ADD_ITEM:({source:r,index:s=-1,interactionMethod:l,success:i=()=>{},failure:a=()=>{},options:o={}})=>{if(fe(r)){a({error:k("error",0,"No source"),file:null});return}if(Ne(r)&&n.options.ignoredFiles.includes(r.name.toLowerCase()))return;if(!yi(n)){if(n.options.allowMultiple||!n.options.allowMultiple&&!n.options.allowReplace){const O=k("warning",0,"Max files");e("DID_THROW_MAX_FILES",{source:r,error:O}),a({error:O,file:null});return}const h=ce(n.items)[0];if(h.status===w.PROCESSING_COMPLETE||h.status===w.PROCESSING_REVERT_ERROR){const O=t("GET_FORCE_REVERT");if(h.revert(xe(n.options.server.url,n.options.server.revert),O).then(()=>{!O||e("ADD_ITEM",{source:r,index:s,interactionMethod:l,success:i,failure:a,options:o})}).catch(()=>{}),O)return}e("REMOVE_ITEM",{query:h.id})}const c=o.type==="local"?$.LOCAL:o.type==="limbo"?$.LIMBO:$.INPUT,u=zi(c,c===$.INPUT?null:r,o.file);Object.keys(o.metadata||{}).forEach(h=>{u.setMetadata(h,o.metadata[h])}),Re("DID_CREATE_ITEM",u,{query:t,dispatch:e});const f=t("GET_ITEM_INSERT_LOCATION");n.options.itemInsertLocationFreedom||(s=f==="before"?-1:n.items.length),Li(n.items,u,s),he(f)&&r&&Ft(n,f);const _=u.id;u.on("init",()=>{e("DID_INIT_ITEM",{id:_})}),u.on("load-init",()=>{e("DID_START_ITEM_LOAD",{id:_})}),u.on("load-meta",()=>{e("DID_UPDATE_ITEM_META",{id:_})}),u.on("load-progress",h=>{e("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:_,progress:h})}),u.on("load-request-error",h=>{const O=lt(n.options.labelFileLoadError)(h);if(h.code>=400&&h.code<500){e("DID_THROW_ITEM_INVALID",{id:_,error:h,status:{main:O,sub:`${h.code} (${h.body})`}}),a({error:h,file:ne(u)});return}e("DID_THROW_ITEM_LOAD_ERROR",{id:_,error:h,status:{main:O,sub:n.options.labelTapToRetry}})}),u.on("load-file-error",h=>{e("DID_THROW_ITEM_INVALID",{id:_,error:h.status,status:h.status}),a({error:h.status,file:ne(u)})}),u.on("load-abort",()=>{e("REMOVE_ITEM",{query:_})}),u.on("load-skip",()=>{e("COMPLETE_LOAD_ITEM",{query:_,item:u,data:{source:r,success:i}})}),u.on("load",()=>{const h=O=>{if(!O){e("REMOVE_ITEM",{query:_});return}u.on("metadata-update",A=>{e("DID_UPDATE_ITEM_METADATA",{id:_,change:A})}),ae("SHOULD_PREPARE_OUTPUT",!1,{item:u,query:t}).then(A=>{const L=t("GET_BEFORE_PREPARE_FILE");L&&(A=L(u,A));const y=()=>{e("COMPLETE_LOAD_ITEM",{query:_,item:u,data:{source:r,success:i}}),Gt(e,n)};if(A){e("REQUEST_PREPARE_OUTPUT",{query:_,item:u,success:N=>{e("DID_PREPARE_OUTPUT",{id:_,file:N}),y()}},!0);return}y()})};ae("DID_LOAD_ITEM",u,{query:t,dispatch:e}).then(()=>{$n(t("GET_BEFORE_ADD_FILE"),ne(u)).then(h)}).catch(O=>{if(!O||!O.error||!O.status)return h(!1);e("DID_THROW_ITEM_INVALID",{id:_,error:O.error,status:O.status})})}),u.on("process-start",()=>{e("DID_START_ITEM_PROCESSING",{id:_})}),u.on("process-progress",h=>{e("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:_,progress:h})}),u.on("process-error",h=>{e("DID_THROW_ITEM_PROCESSING_ERROR",{id:_,error:h,status:{main:lt(n.options.labelFileProcessingError)(h),sub:n.options.labelTapToRetry}})}),u.on("process-revert-error",h=>{e("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:_,error:h,status:{main:lt(n.options.labelFileProcessingRevertError)(h),sub:n.options.labelTapToRetry}})}),u.on("process-complete",h=>{e("DID_COMPLETE_ITEM_PROCESSING",{id:_,error:null,serverFileReference:h}),e("DID_DEFINE_VALUE",{id:_,value:h})}),u.on("process-abort",()=>{e("DID_ABORT_ITEM_PROCESSING",{id:_})}),u.on("process-revert",()=>{e("DID_REVERT_ITEM_PROCESSING",{id:_}),e("DID_DEFINE_VALUE",{id:_,value:null})}),e("DID_ADD_ITEM",{id:_,index:s,interactionMethod:l}),Gt(e,n);const{url:I,load:d,restore:T,fetch:D}=n.options.server||{};u.load(r,Ui(c===$.INPUT?ee(r)&&ki(r)&&D?wt(I,D):jn:c===$.LIMBO?wt(I,T):wt(I,d)),(h,O,A)=>{ae("LOAD_FILE",h,{query:t}).then(O).catch(A)})},REQUEST_PREPARE_OUTPUT:({item:r,success:s,failure:l=()=>{}})=>{const i={error:k("error",0,"Item not found"),file:null};if(r.archived)return l(i);ae("PREPARE_OUTPUT",r.file,{query:t,item:r}).then(a=>{ae("COMPLETE_PREPARE_OUTPUT",a,{query:t,item:r}).then(o=>{if(r.archived)return l(i);s(o)})})},COMPLETE_LOAD_ITEM:({item:r,data:s})=>{const{success:l,source:i}=s,a=t("GET_ITEM_INSERT_LOCATION");if(he(a)&&i&&Ft(n,a),e("DID_LOAD_ITEM",{id:r.id,error:null,serverFileReference:r.origin===$.INPUT?null:i}),l(ne(r)),r.origin===$.LOCAL){e("DID_LOAD_LOCAL_ITEM",{id:r.id});return}if(r.origin===$.LIMBO){e("DID_COMPLETE_ITEM_PROCESSING",{id:r.id,error:null,serverFileReference:i}),e("DID_DEFINE_VALUE",{id:r.id,value:r.serverId||i});return}t("IS_ASYNC")&&n.options.instantUpload&&e("REQUEST_ITEM_PROCESSING",{query:r.id})},RETRY_ITEM_LOAD:oe(n,r=>{r.retryLoad()}),REQUEST_ITEM_PREPARE:oe(n,(r,s,l)=>{e("REQUEST_PREPARE_OUTPUT",{query:r.id,item:r,success:i=>{e("DID_PREPARE_OUTPUT",{id:r.id,file:i}),s({file:r,output:i})},failure:l},!0)}),REQUEST_ITEM_PROCESSING:oe(n,(r,s,l)=>{if(!(r.status===w.IDLE||r.status===w.PROCESSING_ERROR)){const a=()=>e("REQUEST_ITEM_PROCESSING",{query:r,success:s,failure:l}),o=()=>document.hidden?a():setTimeout(a,32);r.status===w.PROCESSING_COMPLETE||r.status===w.PROCESSING_REVERT_ERROR?r.revert(xe(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(o).catch(()=>{}):r.status===w.PROCESSING&&r.abortProcessing().then(o);return}r.status!==w.PROCESSING_QUEUED&&(r.requestProcessing(),e("DID_REQUEST_ITEM_PROCESSING",{id:r.id}),e("PROCESS_ITEM",{query:r,success:s,failure:l},!0))}),PROCESS_ITEM:oe(n,(r,s,l)=>{const i=t("GET_MAX_PARALLEL_UPLOADS");if(t("GET_ITEMS_BY_STATUS",w.PROCESSING).length===i){n.processingQueue.push({id:r.id,success:s,failure:l});return}if(r.status===w.PROCESSING)return;const o=()=>{const u=n.processingQueue.shift();if(!u)return;const{id:f,success:_,failure:I}=u,d=Oe(n.items,f);if(!d||d.archived){o();return}e("PROCESS_ITEM",{query:f,success:_,failure:I},!0)};r.onOnce("process-complete",()=>{s(ne(r)),o();const u=n.options.server;if(n.options.instantUpload&&r.origin===$.LOCAL&&he(u.remove)){const I=()=>{};r.origin=$.LIMBO,n.options.server.remove(r.source,I,I)}t("GET_ITEMS_BY_STATUS",w.PROCESSING_COMPLETE).length===n.items.length&&e("DID_COMPLETE_ITEM_PROCESSING_ALL")}),r.onOnce("process-error",u=>{l({error:u,file:ne(r)}),o()});const c=n.options;r.process(Yi(qi(c.server.url,c.server.process,c.name,{chunkTransferId:r.transferId,chunkServer:c.server.patch,chunkUploads:c.chunkUploads,chunkForce:c.chunkForce,chunkSize:c.chunkSize,chunkRetryDelays:c.chunkRetryDelays}),{allowMinimumUploadDuration:t("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),(u,f,_)=>{ae("PREPARE_OUTPUT",u,{query:t,item:r}).then(I=>{e("DID_PREPARE_OUTPUT",{id:r.id,file:I}),f(I)}).catch(_)})}),RETRY_ITEM_PROCESSING:oe(n,r=>{e("REQUEST_ITEM_PROCESSING",{query:r})}),REQUEST_REMOVE_ITEM:oe(n,r=>{$n(t("GET_BEFORE_REMOVE_FILE"),ne(r)).then(s=>{!s||e("REMOVE_ITEM",{query:r})})}),RELEASE_ITEM:oe(n,r=>{r.release()}),REMOVE_ITEM:oe(n,(r,s,l,i)=>{const a=()=>{const c=r.id;kn(n.items,c).archive(),e("DID_REMOVE_ITEM",{error:null,id:c,item:r}),Gt(e,n),s(ne(r))},o=n.options.server;r.origin===$.LOCAL&&o&&he(o.remove)&&i.remove!==!1?(e("DID_START_ITEM_REMOVE",{id:r.id}),o.remove(r.source,()=>a(),c=>{e("DID_THROW_ITEM_REMOVE_ERROR",{id:r.id,error:k("error",0,c,null),status:{main:lt(n.options.labelFileRemoveError)(c),sub:n.options.labelTapToRetry}})})):((i.revert&&r.origin!==$.LOCAL&&r.serverId!==null||n.options.chunkUploads&&r.file.size>n.options.chunkSize||n.options.chunkUploads&&n.options.chunkForce)&&r.revert(xe(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")),a())}),ABORT_ITEM_LOAD:oe(n,r=>{r.abortLoad()}),ABORT_ITEM_PROCESSING:oe(n,r=>{if(r.serverId){e("REVERT_ITEM_PROCESSING",{id:r.id});return}r.abortProcessing().then(()=>{n.options.instantUpload&&e("REMOVE_ITEM",{query:r.id})})}),REQUEST_REVERT_ITEM_PROCESSING:oe(n,r=>{if(!n.options.instantUpload){e("REVERT_ITEM_PROCESSING",{query:r});return}const s=a=>{!a||e("REVERT_ITEM_PROCESSING",{query:r})},l=t("GET_BEFORE_REMOVE_FILE");if(!l)return s(!0);const i=l(ne(r));if(i==null)return s(!0);if(typeof i=="boolean")return s(i);typeof i.then=="function"&&i.then(s)}),REVERT_ITEM_PROCESSING:oe(n,r=>{r.revert(xe(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(()=>{(n.options.instantUpload||ji(r))&&e("REMOVE_ITEM",{query:r.id})}).catch(()=>{})}),SET_OPTIONS:({options:r})=>{const s=Object.keys(r),l=$i.filter(a=>s.includes(a));[...l,...Object.keys(r).filter(a=>!l.includes(a))].forEach(a=>{e(`SET_${tt(a,"_").toUpperCase()}`,{value:r[a]})})}}),$i=["server"],Bt=e=>e,Ee=e=>document.createElement(e),W=(e,t)=>{let n=e.childNodes[0];n?t!==n.nodeValue&&(n.nodeValue=t):(n=document.createTextNode(t),e.appendChild(n))},Kn=(e,t,n,r)=>{const s=(r%360-90)*Math.PI/180;return{x:e+n*Math.cos(s),y:t+n*Math.sin(s)}},Ki=(e,t,n,r,s,l)=>{const i=Kn(e,t,n,s),a=Kn(e,t,n,r);return["M",i.x,i.y,"A",n,n,0,l,0,a.x,a.y].join(" ")},Zi=(e,t,n,r,s)=>{let l=1;return s>r&&s-r<=.5&&(l=0),r>s&&r-s>=.5&&(l=0),Ki(e,t,n,Math.min(.9999,r)*360,Math.min(.9999,s)*360,l)},Ji=({root:e,props:t})=>{t.spin=!1,t.progress=0,t.opacity=0;const n=Ke("svg");e.ref.path=Ke("path",{"stroke-width":2,"stroke-linecap":"round"}),n.appendChild(e.ref.path),e.ref.svg=n,e.appendChild(n)},el=({root:e,props:t})=>{if(t.opacity===0)return;t.align&&(e.element.dataset.align=t.align);const n=parseInt(z(e.ref.path,"stroke-width"),10),r=e.rect.element.width*.5;let s=0,l=0;t.spin?(s=0,l=.5):(s=0,l=t.progress);const i=Zi(r,r,r-n,s,l);z(e.ref.path,"d",i),z(e.ref.path,"stroke-opacity",t.spin||t.progress>0?1:0)},Zn=X({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:Ji,write:el,mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),tl=({root:e,props:t})=>{e.element.innerHTML=(t.icon||"")+`<span>${t.label}</span>`,t.isDisabled=!1},nl=({root:e,props:t})=>{const{isDisabled:n}=t,r=e.query("GET_DISABLED")||t.opacity===0;r&&!n?(t.isDisabled=!0,z(e.element,"disabled","disabled")):!r&&n&&(t.isDisabled=!1,e.element.removeAttribute("disabled"))},Jn=X({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:tl,write:nl}),er=(e,t=".",n=1e3,r={})=>{const{labelBytes:s="bytes",labelKilobytes:l="KB",labelMegabytes:i="MB",labelGigabytes:a="GB"}=r;e=Math.round(Math.abs(e));const o=n,c=n*n,u=n*n*n;return e<o?`${e} ${s}`:e<c?`${Math.floor(e/o)} ${l}`:e<u?`${tr(e/c,1,t)} ${i}`:`${tr(e/u,2,t)} ${a}`},tr=(e,t,n)=>e.toFixed(t).split(".").filter(r=>r!=="0").join(n),rl=({root:e,props:t})=>{const n=Ee("span");n.className="filepond--file-info-main",z(n,"aria-hidden","true"),e.appendChild(n),e.ref.fileName=n;const r=Ee("span");r.className="filepond--file-info-sub",e.appendChild(r),e.ref.fileSize=r,W(r,e.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),W(n,Bt(e.query("GET_ITEM_NAME",t.id)))},Ut=({root:e,props:t})=>{W(e.ref.fileSize,er(e.query("GET_ITEM_SIZE",t.id),".",e.query("GET_FILE_SIZE_BASE"),e.query("GET_FILE_SIZE_LABELS",e.query))),W(e.ref.fileName,Bt(e.query("GET_ITEM_NAME",t.id)))},nr=({root:e,props:t})=>{if(be(e.query("GET_ITEM_SIZE",t.id))){Ut({root:e,props:t});return}W(e.ref.fileSize,e.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},sl=X({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:J({DID_LOAD_ITEM:Ut,DID_UPDATE_ITEM_META:Ut,DID_THROW_ITEM_LOAD_ERROR:nr,DID_THROW_ITEM_INVALID:nr}),didCreateView:e=>{Re("CREATE_VIEW",Y(C({},e),{view:e}))},create:rl,mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),rr=e=>Math.round(e*100),il=({root:e})=>{const t=Ee("span");t.className="filepond--file-status-main",e.appendChild(t),e.ref.main=t;const n=Ee("span");n.className="filepond--file-status-sub",e.appendChild(n),e.ref.sub=n,sr({root:e,action:{progress:null}})},sr=({root:e,action:t})=>{const n=t.progress===null?e.query("GET_LABEL_FILE_LOADING"):`${e.query("GET_LABEL_FILE_LOADING")} ${rr(t.progress)}%`;W(e.ref.main,n),W(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},ll=({root:e,action:t})=>{const n=t.progress===null?e.query("GET_LABEL_FILE_PROCESSING"):`${e.query("GET_LABEL_FILE_PROCESSING")} ${rr(t.progress)}%`;W(e.ref.main,n),W(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},ol=({root:e})=>{W(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING")),W(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},al=({root:e})=>{W(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_ABORTED")),W(e.ref.sub,e.query("GET_LABEL_TAP_TO_RETRY"))},cl=({root:e})=>{W(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),W(e.ref.sub,e.query("GET_LABEL_TAP_TO_UNDO"))},ir=({root:e})=>{W(e.ref.main,""),W(e.ref.sub,"")},qe=({root:e,action:t})=>{W(e.ref.main,t.status.main),W(e.ref.sub,t.status.sub)},ul=X({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:J({DID_LOAD_ITEM:ir,DID_REVERT_ITEM_PROCESSING:ir,DID_REQUEST_ITEM_PROCESSING:ol,DID_ABORT_ITEM_PROCESSING:al,DID_COMPLETE_ITEM_PROCESSING:cl,DID_UPDATE_ITEM_PROCESS_PROGRESS:ll,DID_UPDATE_ITEM_LOAD_PROGRESS:sr,DID_THROW_ITEM_LOAD_ERROR:qe,DID_THROW_ITEM_INVALID:qe,DID_THROW_ITEM_PROCESSING_ERROR:qe,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:qe,DID_THROW_ITEM_REMOVE_ERROR:qe}),didCreateView:e=>{Re("CREATE_VIEW",Y(C({},e),{view:e}))},create:il,mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),Vt={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},xt=[];H(Vt,e=>{xt.push(e)});const re=e=>{if(qt(e)==="right")return 0;const t=e.ref.buttonRemoveItem.rect.element;return t.hidden?null:t.width+t.left},dl=e=>e.ref.buttonAbortItemLoad.rect.element.width,ot=e=>Math.floor(e.ref.buttonRemoveItem.rect.element.height/4),fl=e=>Math.floor(e.ref.buttonRemoveItem.rect.element.left/2),El=e=>e.query("GET_STYLE_LOAD_INDICATOR_POSITION"),_l=e=>e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION"),qt=e=>e.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION"),pl={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:El},processProgressIndicator:{opacity:0,align:_l},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},lr={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:re},status:{translateX:re}},Ht={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},ve={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:re},status:{translateX:re,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:re},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:qt},info:{translateX:re},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:qt},buttonRemoveItem:{opacity:1},info:{translateX:re},status:{opacity:1,translateX:re}},DID_LOAD_ITEM:lr,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:re},status:{translateX:re}},DID_START_ITEM_PROCESSING:Ht,DID_REQUEST_ITEM_PROCESSING:Ht,DID_UPDATE_ITEM_PROCESS_PROGRESS:Ht,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:re}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:re},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:lr},Il=X({create:({root:e})=>{e.element.innerHTML=e.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),Tl=({root:e,props:t})=>{const n=Object.keys(Vt).reduce((d,T)=>(d[T]=C({},Vt[T]),d),{}),{id:r}=t,s=e.query("GET_ALLOW_REVERT"),l=e.query("GET_ALLOW_REMOVE"),i=e.query("GET_ALLOW_PROCESS"),a=e.query("GET_INSTANT_UPLOAD"),o=e.query("IS_ASYNC"),c=e.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");let u;o?i&&!s?u=d=>!/RevertItemProcessing/.test(d):!i&&s?u=d=>!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(d):!i&&!s&&(u=d=>!/Process/.test(d)):u=d=>!/Process/.test(d);const f=u?xt.filter(u):xt.concat();if(a&&s&&(n.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",n.RevertItemProcessing.icon="GET_ICON_REMOVE"),o&&!s){const d=ve.DID_COMPLETE_ITEM_PROCESSING;d.info.translateX=fl,d.info.translateY=ot,d.status.translateY=ot,d.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(o&&!i&&(["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach(d=>{ve[d].status.translateY=ot}),ve.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=dl),c&&s){n.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";const d=ve.DID_COMPLETE_ITEM_PROCESSING;d.info.translateX=re,d.status.translateY=ot,d.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}l||(n.RemoveItem.disabled=!0),H(n,(d,T)=>{const D=e.createChildView(Jn,{label:e.query(T.label),icon:e.query(T.icon),opacity:0});f.includes(d)&&e.appendChildView(D),T.disabled&&(D.element.setAttribute("disabled","disabled"),D.element.setAttribute("hidden","hidden")),D.element.dataset.align=e.query(`GET_STYLE_${T.align}`),D.element.classList.add(T.className),D.on("click",h=>{h.stopPropagation(),!T.disabled&&e.dispatch(T.action,{query:r})}),e.ref[`button${d}`]=D}),e.ref.processingCompleteIndicator=e.appendChildView(e.createChildView(Il)),e.ref.processingCompleteIndicator.element.dataset.align=e.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION"),e.ref.info=e.appendChildView(e.createChildView(sl,{id:r})),e.ref.status=e.appendChildView(e.createChildView(ul,{id:r}));const _=e.appendChildView(e.createChildView(Zn,{opacity:0,align:e.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));_.element.classList.add("filepond--load-indicator"),e.ref.loadProgressIndicator=_;const I=e.appendChildView(e.createChildView(Zn,{opacity:0,align:e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));I.element.classList.add("filepond--process-indicator"),e.ref.processProgressIndicator=I,e.ref.activeStyles=[]},ml=({root:e,actions:t,props:n})=>{gl({root:e,actions:t,props:n});let r=t.concat().filter(s=>/^DID_/.test(s.type)).reverse().find(s=>ve[s.type]);if(r){e.ref.activeStyles=[];const s=ve[r.type];H(pl,(l,i)=>{const a=e.ref[l];H(i,(o,c)=>{const u=s[l]&&typeof s[l][o]!="undefined"?s[l][o]:c;e.ref.activeStyles.push({control:a,key:o,value:u})})})}e.ref.activeStyles.forEach(({control:s,key:l,value:i})=>{s[l]=typeof i=="function"?i(e):i})},gl=J({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:({root:e,action:t})=>{e.ref.buttonAbortItemProcessing.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:({root:e,action:t})=>{e.ref.buttonAbortItemLoad.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:({root:e,action:t})=>{e.ref.buttonAbortItemRemoval.label=t.value},DID_REQUEST_ITEM_PROCESSING:({root:e})=>{e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:({root:e})=>{e.ref.loadProgressIndicator.spin=!0,e.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:({root:e})=>{e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:({root:e,action:t})=>{e.ref.loadProgressIndicator.spin=!1,e.ref.loadProgressIndicator.progress=t.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:({root:e,action:t})=>{e.ref.processProgressIndicator.spin=!1,e.ref.processProgressIndicator.progress=t.progress}}),hl=X({create:Tl,write:ml,didCreateView:e=>{Re("CREATE_VIEW",Y(C({},e),{view:e}))},name:"file"}),Rl=({root:e,props:t})=>{e.ref.fileName=Ee("legend"),e.appendChild(e.ref.fileName),e.ref.file=e.appendChildView(e.createChildView(hl,{id:t.id})),e.ref.data=!1},Ol=({root:e,props:t})=>{W(e.ref.fileName,Bt(e.query("GET_ITEM_NAME",t.id)))},Dl=X({create:Rl,ignoreRect:!0,write:J({DID_LOAD_ITEM:Ol}),didCreateView:e=>{Re("CREATE_VIEW",Y(C({},e),{view:e}))},tag:"fieldset",name:"file-wrapper"}),or={type:"spring",damping:.6,mass:7},Sl=({root:e,props:t})=>{[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:or},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:or},styles:["translateY"]}}].forEach(n=>{yl(e,n,t.name)}),e.element.classList.add(`filepond--${t.name}`),e.ref.scalable=null},yl=(e,t,n)=>{const r=X({name:`panel-${t.name} filepond--${n}`,mixins:t.mixins,ignoreRectUpdate:!0}),s=e.createChildView(r,t.props);e.ref[t.name]=e.appendChildView(s)},Al=({root:e,props:t})=>{if((e.ref.scalable===null||t.scalable!==e.ref.scalable)&&(e.ref.scalable=An(t.scalable)?t.scalable:!0,e.element.dataset.scalable=e.ref.scalable),!t.height)return;const n=e.ref.top.rect.element,r=e.ref.bottom.rect.element,s=Math.max(n.height+r.height,t.height);e.ref.center.translateY=n.height,e.ref.center.scaleY=(s-n.height-r.height)/100,e.ref.bottom.translateY=s-r.height},ar=X({name:"panel",read:({root:e,props:t})=>t.heightCurrent=e.ref.bottom.translateY,write:Al,create:Sl,ignoreRect:!0,mixins:{apis:["height","heightCurrent","scalable"]}}),Ll=e=>{const t=e.map(r=>r.id);let n;return{setIndex:r=>{n=r},getIndex:()=>n,getItemIndex:r=>t.indexOf(r.id)}},cr={type:"spring",stiffness:.75,damping:.45,mass:10},ur="spring",dr={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},Pl=({root:e,props:t})=>{if(e.ref.handleClick=r=>e.dispatch("DID_ACTIVATE_ITEM",{id:t.id}),e.element.id=`filepond--item-${t.id}`,e.element.addEventListener("click",e.ref.handleClick),e.ref.container=e.appendChildView(e.createChildView(Dl,{id:t.id})),e.ref.panel=e.appendChildView(e.createChildView(ar,{name:"item-panel"})),e.ref.panel.height=null,t.markedForRemoval=!1,!e.query("GET_ALLOW_REORDER"))return;e.element.dataset.dragState="idle";const n=r=>{if(!r.isPrimary)return;let s=!1;const l={x:r.pageX,y:r.pageY};t.dragOrigin={x:e.translateX,y:e.translateY},t.dragCenter={x:r.offsetX,y:r.offsetY};const i=Ll(e.query("GET_ACTIVE_ITEMS"));e.dispatch("DID_GRAB_ITEM",{id:t.id,dragState:i});const a=c=>{if(!c.isPrimary)return;c.stopPropagation(),c.preventDefault(),t.dragOffset={x:c.pageX-l.x,y:c.pageY-l.y},t.dragOffset.x*t.dragOffset.x+t.dragOffset.y*t.dragOffset.y>16&&!s&&(s=!0,e.element.removeEventListener("click",e.ref.handleClick)),e.dispatch("DID_DRAG_ITEM",{id:t.id,dragState:i})},o=c=>{!c.isPrimary||(document.removeEventListener("pointermove",a),document.removeEventListener("pointerup",o),t.dragOffset={x:c.pageX-l.x,y:c.pageY-l.y},e.dispatch("DID_DROP_ITEM",{id:t.id,dragState:i}),s&&setTimeout(()=>e.element.addEventListener("click",e.ref.handleClick),0))};document.addEventListener("pointermove",a),document.addEventListener("pointerup",o)};e.element.addEventListener("pointerdown",n)},bl=J({DID_UPDATE_PANEL_HEIGHT:({root:e,action:t})=>{e.height=t.height}}),Ml=J({DID_GRAB_ITEM:({root:e,props:t})=>{t.dragOrigin={x:e.translateX,y:e.translateY}},DID_DRAG_ITEM:({root:e})=>{e.element.dataset.dragState="drag"},DID_DROP_ITEM:({root:e,props:t})=>{t.dragOffset=null,t.dragOrigin=null,e.element.dataset.dragState="drop"}},({root:e,actions:t,props:n,shouldOptimize:r})=>{e.element.dataset.dragState==="drop"&&e.scaleX<=1&&(e.element.dataset.dragState="idle");let s=t.concat().filter(i=>/^DID_/.test(i.type)).reverse().find(i=>dr[i.type]);s&&s.type!==n.currentState&&(n.currentState=s.type,e.element.dataset.filepondItemState=dr[n.currentState]||"");const l=e.query("GET_ITEM_PANEL_ASPECT_RATIO")||e.query("GET_PANEL_ASPECT_RATIO");l?r||(e.height=e.rect.element.width*l):(bl({root:e,actions:t,props:n}),!e.height&&e.ref.container.rect.element.height>0&&(e.height=e.ref.container.rect.element.height)),r&&(e.ref.panel.height=null),e.ref.panel.height=e.height}),Cl=X({create:Pl,write:Ml,destroy:({root:e,props:t})=>{e.element.removeEventListener("click",e.ref.handleClick),e.dispatch("RELEASE_ITEM",{query:t.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:ur,scaleY:ur,translateX:cr,translateY:cr,opacity:{type:"tween",duration:150}}}});var Yt=(e,t)=>Math.max(1,Math.floor((e+1)/t));const Wt=(e,t,n)=>{if(!n)return;const r=e.rect.element.width,s=t.length;let l=null;if(s===0||n.top<t[0].rect.element.top)return-1;const a=t[0].rect.element,o=a.marginLeft+a.marginRight,c=a.width+o,u=Yt(r,c);if(u===1){for(let I=0;I<s;I++){const d=t[I],T=d.rect.outer.top+d.rect.element.height*.5;if(n.top<T)return I}return s}const f=a.marginTop+a.marginBottom,_=a.height+f;for(let I=0;I<s;I++){const d=I%u,T=Math.floor(I/u),D=d*c,h=T*_,O=h-a.marginTop,A=D+c,L=h+_+a.marginBottom;if(n.top<L&&n.top>O){if(n.left<A)return I;I!==s-1?l=I:l=null}}return l!==null?l:s},at={height:0,width:0,get getHeight(){return this.height},set setHeight(e){(this.height===0||e===0)&&(this.height=e)},get getWidth(){return this.width},set setWidth(e){(this.width===0||e===0)&&(this.width=e)},setDimensions:function(e,t){(this.height===0||e===0)&&(this.height=e),(this.width===0||t===0)&&(this.width=t)}},Nl=({root:e})=>{z(e.element,"role","list"),e.ref.lastItemSpanwDate=Date.now()},vl=({root:e,action:t})=>{const{id:n,index:r,interactionMethod:s}=t;e.ref.addIndex=r;const l=Date.now();let i=l,a=1;if(s!==ie.NONE){a=0;const o=e.query("GET_ITEM_INSERT_INTERVAL"),c=l-e.ref.lastItemSpanwDate;i=c<o?l+(o-c):l}e.ref.lastItemSpanwDate=i,e.appendChildView(e.createChildView(Cl,{spawnDate:i,id:n,opacity:a,interactionMethod:s}),r)},fr=(e,t,n,r=0,s=1)=>{e.dragOffset?(e.translateX=null,e.translateY=null,e.translateX=e.dragOrigin.x+e.dragOffset.x,e.translateY=e.dragOrigin.y+e.dragOffset.y,e.scaleX=1.025,e.scaleY=1.025):(e.translateX=t,e.translateY=n,Date.now()>e.spawnDate&&(e.opacity===0&&wl(e,t,n,r,s),e.scaleX=1,e.scaleY=1,e.opacity=1))},wl=(e,t,n,r,s)=>{e.interactionMethod===ie.NONE?(e.translateX=null,e.translateX=t,e.translateY=null,e.translateY=n):e.interactionMethod===ie.DROP?(e.translateX=null,e.translateX=t-r*20,e.translateY=null,e.translateY=n-s*10,e.scaleX=.8,e.scaleY=.8):e.interactionMethod===ie.BROWSE?(e.translateY=null,e.translateY=n-30):e.interactionMethod===ie.API&&(e.translateX=null,e.translateX=t-30,e.translateY=null)},Gl=({root:e,action:t})=>{const{id:n}=t,r=e.childViews.find(s=>s.id===n);!r||(r.scaleX=.9,r.scaleY=.9,r.opacity=0,r.markedForRemoval=!0)},zt=e=>e.rect.element.height+e.rect.element.marginBottom*.5+e.rect.element.marginTop*.5,Fl=e=>e.rect.element.width+e.rect.element.marginLeft*.5+e.rect.element.marginRight*.5,Bl=({root:e,action:t})=>{const{id:n,dragState:r}=t,s=e.query("GET_ITEM",{id:n}),l=e.childViews.find(D=>D.id===n),i=e.childViews.length,a=r.getItemIndex(s);if(!l)return;const o={x:l.dragOrigin.x+l.dragOffset.x+l.dragCenter.x,y:l.dragOrigin.y+l.dragOffset.y+l.dragCenter.y},c=zt(l),u=Fl(l);let f=Math.floor(e.rect.outer.width/u);f>i&&(f=i);const _=Math.floor(i/f+1);at.setHeight=c*_,at.setWidth=u*f;var I={y:Math.floor(o.y/c),x:Math.floor(o.x/u),getGridIndex:function(){return o.y>at.getHeight||o.y<0||o.x>at.getWidth||o.x<0?a:this.y*f+this.x},getColIndex:function(){const h=e.query("GET_ACTIVE_ITEMS"),O=e.childViews.filter(S=>S.rect.element.height),A=h.map(S=>O.find(v=>v.id===S.id)),L=A.findIndex(S=>S===l),y=zt(l),N=A.length;let U=N,R=0,b=0,G=0;for(let S=0;S<N;S++)if(R=zt(A[S]),G=b,b=G+R,o.y<b){if(L>S){if(o.y<G+y){U=S;break}continue}U=S;break}return U}};const d=f>1?I.getGridIndex():I.getColIndex();e.dispatch("MOVE_ITEM",{query:l,index:d});const T=r.getIndex();if(T===void 0||T!==d){if(r.setIndex(d),T===void 0)return;e.dispatch("DID_REORDER_ITEMS",{items:e.query("GET_ACTIVE_ITEMS"),origin:a,target:d})}},Ul=J({DID_ADD_ITEM:vl,DID_REMOVE_ITEM:Gl,DID_DRAG_ITEM:Bl}),Vl=({root:e,props:t,actions:n,shouldOptimize:r})=>{Ul({root:e,props:t,actions:n});const{dragCoordinates:s}=t,l=e.rect.element.width,i=e.childViews.filter(A=>A.rect.element.height),a=e.query("GET_ACTIVE_ITEMS").map(A=>i.find(L=>L.id===A.id)).filter(A=>A),o=s?Wt(e,a,s):null,c=e.ref.addIndex||null;e.ref.addIndex=null;let u=0,f=0,_=0;if(a.length===0)return;const I=a[0].rect.element,d=I.marginTop+I.marginBottom,T=I.marginLeft+I.marginRight,D=I.width+T,h=I.height+d,O=Yt(l,D);if(O===1){let A=0,L=0;a.forEach((y,N)=>{if(o){let b=N-o;b===-2?L=-d*.25:b===-1?L=-d*.75:b===0?L=d*.75:b===1?L=d*.25:L=0}r&&(y.translateX=null,y.translateY=null),y.markedForRemoval||fr(y,0,A+L),A+=(y.rect.element.height+d)*(y.markedForRemoval?y.opacity:1)})}else{let A=0,L=0;a.forEach((y,N)=>{N===o&&(u=1),N===c&&(_+=1),y.markedForRemoval&&y.opacity<.5&&(f-=1);const U=N+_+u+f,R=U%O,b=Math.floor(U/O),G=R*D,S=b*h,v=Math.sign(G-A),j=Math.sign(S-L);A=G,L=S,!y.markedForRemoval&&(r&&(y.translateX=null,y.translateY=null),fr(y,G,S,v,j))})}},xl=(e,t)=>t.filter(n=>n.data&&n.data.id?e.id===n.data.id:!0),ql=X({create:Nl,write:Vl,tag:"ul",name:"list",didWriteView:({root:e})=>{e.childViews.filter(t=>t.markedForRemoval&&t.opacity===0&&t.resting).forEach(t=>{t._destroy(),e.removeChildView(t)})},filterFrameActionsForChild:xl,mixins:{apis:["dragCoordinates"]}}),Hl=({root:e,props:t})=>{e.ref.list=e.appendChildView(e.createChildView(ql)),t.dragCoordinates=null,t.overflowing=!1},Yl=({root:e,props:t,action:n})=>{!e.query("GET_ITEM_INSERT_LOCATION_FREEDOM")||(t.dragCoordinates={left:n.position.scopeLeft-e.ref.list.rect.element.left,top:n.position.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},Wl=({props:e})=>{e.dragCoordinates=null},zl=J({DID_DRAG:Yl,DID_END_DRAG:Wl}),Xl=({root:e,props:t,actions:n})=>{if(zl({root:e,props:t,actions:n}),e.ref.list.dragCoordinates=t.dragCoordinates,t.overflowing&&!t.overflow&&(t.overflowing=!1,e.element.dataset.state="",e.height=null),t.overflow){const r=Math.round(t.overflow);r!==e.height&&(t.overflowing=!0,e.element.dataset.state="overflow",e.height=r)}},kl=X({create:Hl,write:Xl,name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),ue=(e,t,n,r="")=>{n?z(e,t,r):e.removeAttribute(t)},jl=e=>{if(!(!e||e.value==="")){try{e.value=""}catch{}if(e.value){const t=Ee("form"),n=e.parentNode,r=e.nextSibling;t.appendChild(e),t.reset(),r?n.insertBefore(e,r):n.appendChild(e)}}},Ql=({root:e,props:t})=>{e.element.id=`filepond--browser-${t.id}`,z(e.element,"name",e.query("GET_NAME")),z(e.element,"aria-controls",`filepond--assistant-${t.id}`),z(e.element,"aria-labelledby",`filepond--drop-label-${t.id}`),Er({root:e,action:{value:e.query("GET_ACCEPTED_FILE_TYPES")}}),_r({root:e,action:{value:e.query("GET_ALLOW_MULTIPLE")}}),pr({root:e,action:{value:e.query("GET_ALLOW_DIRECTORIES_ONLY")}}),Xt({root:e}),Ir({root:e,action:{value:e.query("GET_REQUIRED")}}),Tr({root:e,action:{value:e.query("GET_CAPTURE_METHOD")}}),e.ref.handleChange=n=>{if(!e.element.value)return;const r=Array.from(e.element.files).map(s=>(s._relativePath=s.webkitRelativePath,s));setTimeout(()=>{t.onload(r),jl(e.element)},250)},e.element.addEventListener("change",e.ref.handleChange)},Er=({root:e,action:t})=>{!e.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")||ue(e.element,"accept",!!t.value,t.value?t.value.join(","):"")},_r=({root:e,action:t})=>{ue(e.element,"multiple",t.value)},pr=({root:e,action:t})=>{ue(e.element,"webkitdirectory",t.value)},Xt=({root:e})=>{const t=e.query("GET_DISABLED"),n=e.query("GET_ALLOW_BROWSE"),r=t||!n;ue(e.element,"disabled",r)},Ir=({root:e,action:t})=>{t.value?e.query("GET_TOTAL_ITEMS")===0&&ue(e.element,"required",!0):ue(e.element,"required",!1)},Tr=({root:e,action:t})=>{ue(e.element,"capture",!!t.value,t.value===!0?"":t.value)},mr=({root:e})=>{const{element:t}=e;e.query("GET_TOTAL_ITEMS")>0?(ue(t,"required",!1),ue(t,"name",!1)):(ue(t,"name",!0,e.query("GET_NAME")),e.query("GET_CHECK_VALIDITY")&&t.setCustomValidity(""),e.query("GET_REQUIRED")&&ue(t,"required",!0))},$l=({root:e})=>{!e.query("GET_CHECK_VALIDITY")||e.element.setCustomValidity(e.query("GET_LABEL_INVALID_FIELD"))},Kl=X({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:Ql,destroy:({root:e})=>{e.element.removeEventListener("change",e.ref.handleChange)},write:J({DID_LOAD_ITEM:mr,DID_REMOVE_ITEM:mr,DID_THROW_ITEM_INVALID:$l,DID_SET_DISABLED:Xt,DID_SET_ALLOW_BROWSE:Xt,DID_SET_ALLOW_DIRECTORIES_ONLY:pr,DID_SET_ALLOW_MULTIPLE:_r,DID_SET_ACCEPTED_FILE_TYPES:Er,DID_SET_CAPTURE_METHOD:Tr,DID_SET_REQUIRED:Ir})}),gr={ENTER:13,SPACE:32},Zl=({root:e,props:t})=>{const n=Ee("label");z(n,"for",`filepond--browser-${t.id}`),z(n,"id",`filepond--drop-label-${t.id}`),z(n,"aria-hidden","true"),e.ref.handleKeyDown=r=>{(r.keyCode===gr.ENTER||r.keyCode===gr.SPACE)&&(r.preventDefault(),e.ref.label.click())},e.ref.handleClick=r=>{r.target===n||n.contains(r.target)||e.ref.label.click()},n.addEventListener("keydown",e.ref.handleKeyDown),e.element.addEventListener("click",e.ref.handleClick),hr(n,t.caption),e.appendChild(n),e.ref.label=n},hr=(e,t)=>{e.innerHTML=t;const n=e.querySelector(".filepond--label-action");return n&&z(n,"tabindex","0"),t},Jl=X({name:"drop-label",ignoreRect:!0,create:Zl,destroy:({root:e})=>{e.ref.label.addEventListener("keydown",e.ref.handleKeyDown),e.element.removeEventListener("click",e.ref.handleClick)},write:J({DID_SET_LABEL_IDLE:({root:e,action:t})=>{hr(e.ref.label,t.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),eo=X({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),to=({root:e})=>{const t=e.rect.element.width*.5,n=e.rect.element.height*.5;e.ref.blob=e.appendChildView(e.createChildView(eo,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:t,translateY:n}))},no=({root:e,action:t})=>{if(!e.ref.blob){to({root:e});return}e.ref.blob.translateX=t.position.scopeLeft,e.ref.blob.translateY=t.position.scopeTop,e.ref.blob.scaleX=1,e.ref.blob.scaleY=1,e.ref.blob.opacity=1},ro=({root:e})=>{!e.ref.blob||(e.ref.blob.opacity=0)},so=({root:e})=>{!e.ref.blob||(e.ref.blob.scaleX=2.5,e.ref.blob.scaleY=2.5,e.ref.blob.opacity=0)},io=({root:e,props:t,actions:n})=>{lo({root:e,props:t,actions:n});const{blob:r}=e.ref;n.length===0&&r&&r.opacity===0&&(e.removeChildView(r),e.ref.blob=null)},lo=J({DID_DRAG:no,DID_DROP:so,DID_END_DRAG:ro}),oo=X({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:io}),Rr=(e,t)=>{try{const n=new DataTransfer;t.forEach(r=>{r instanceof File?n.items.add(r):n.items.add(new File([r],r.name,{type:r.type}))}),e.files=n.files}catch{return!1}return!0},ao=({root:e})=>e.ref.fields={},ct=(e,t)=>e.ref.fields[t],kt=e=>{e.query("GET_ACTIVE_ITEMS").forEach(t=>{!e.ref.fields[t.id]||e.element.appendChild(e.ref.fields[t.id])})},Or=({root:e})=>kt(e),co=({root:e,action:t})=>{const s=!(e.query("GET_ITEM",t.id).origin===$.LOCAL)&&e.query("SHOULD_UPDATE_FILE_INPUT"),l=Ee("input");l.type=s?"file":"hidden",l.name=e.query("GET_NAME"),l.disabled=e.query("GET_DISABLED"),e.ref.fields[t.id]=l,kt(e)},uo=({root:e,action:t})=>{const n=ct(e,t.id);if(!n||(t.serverFileReference!==null&&(n.value=t.serverFileReference),!e.query("SHOULD_UPDATE_FILE_INPUT")))return;const r=e.query("GET_ITEM",t.id);Rr(n,[r.file])},fo=({root:e,action:t})=>{!e.query("SHOULD_UPDATE_FILE_INPUT")||setTimeout(()=>{const n=ct(e,t.id);!n||Rr(n,[t.file])},0)},Eo=({root:e})=>{e.element.disabled=e.query("GET_DISABLED")},_o=({root:e,action:t})=>{const n=ct(e,t.id);!n||(n.parentNode&&n.parentNode.removeChild(n),delete e.ref.fields[t.id])},po=({root:e,action:t})=>{const n=ct(e,t.id);!n||(t.value===null?n.removeAttribute("value"):n.value=t.value,kt(e))},Io=J({DID_SET_DISABLED:Eo,DID_ADD_ITEM:co,DID_LOAD_ITEM:uo,DID_REMOVE_ITEM:_o,DID_DEFINE_VALUE:po,DID_PREPARE_OUTPUT:fo,DID_REORDER_ITEMS:Or,DID_SORT_ITEMS:Or}),To=X({tag:"fieldset",name:"data",create:ao,write:Io,ignoreRect:!0}),mo=e=>"getRootNode"in e?e.getRootNode():document,go=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],ho=["css","csv","html","txt"],Ro={zip:"zip|compressed",epub:"application/epub+zip"},Dr=(e="")=>(e=e.toLowerCase(),go.includes(e)?"image/"+(e==="jpg"?"jpeg":e==="svg"?"svg+xml":e):ho.includes(e)?"text/"+e:Ro[e]||""),jt=e=>new Promise((t,n)=>{const r=bo(e);if(r.length&&!Oo(e))return t(r);Do(e).then(t)}),Oo=e=>e.files?e.files.length>0:!1,Do=e=>new Promise((t,n)=>{const r=(e.items?Array.from(e.items):[]).filter(s=>So(s)).map(s=>yo(s));if(!r.length){t(e.files?Array.from(e.files):[]);return}Promise.all(r).then(s=>{const l=[];s.forEach(i=>{l.push.apply(l,i)}),t(l.filter(i=>i).map(i=>(i._relativePath||(i._relativePath=i.webkitRelativePath),i)))}).catch(console.error)}),So=e=>{if(Sr(e)){const t=Qt(e);if(t)return t.isFile||t.isDirectory}return e.kind==="file"},yo=e=>new Promise((t,n)=>{if(Po(e)){Ao(Qt(e)).then(t).catch(n);return}t([e.getAsFile()])}),Ao=e=>new Promise((t,n)=>{const r=[];let s=0,l=0;const i=()=>{l===0&&s===0&&t(r)},a=o=>{s++;const c=o.createReader(),u=()=>{c.readEntries(f=>{if(f.length===0){s--,i();return}f.forEach(_=>{_.isDirectory?a(_):(l++,_.file(I=>{const d=Lo(I);_.fullPath&&(d._relativePath=_.fullPath),r.push(d),l--,i()}))}),u()},n)};u()};a(e)}),Lo=e=>{if(e.type.length)return e;const t=e.lastModifiedDate,n=e.name,r=Dr(it(e.name));return r.length&&(e=e.slice(0,e.size,r),e.name=n,e.lastModifiedDate=t),e},Po=e=>Sr(e)&&(Qt(e)||{}).isDirectory,Sr=e=>"webkitGetAsEntry"in e,Qt=e=>e.webkitGetAsEntry(),bo=e=>{let t=[];try{if(t=Co(e),t.length)return t;t=Mo(e)}catch{}return t},Mo=e=>{let t=e.getData("url");return typeof t=="string"&&t.length?[t]:[]},Co=e=>{let t=e.getData("text/html");if(typeof t=="string"&&t.length){const n=t.match(/src\s*=\s*"(.+?)"/);if(n)return[n[1]]}return[]},ut=[],ye=e=>({pageLeft:e.pageX,pageTop:e.pageY,scopeLeft:e.offsetX||e.layerX,scopeTop:e.offsetY||e.layerY}),No=(e,t,n)=>{const r=vo(t),s={element:e,filterElement:n,state:null,ondrop:()=>{},onenter:()=>{},ondrag:()=>{},onexit:()=>{},onload:()=>{},allowdrop:()=>{}};return s.destroy=r.addListener(s),s},vo=e=>{const t=ut.find(r=>r.element===e);if(t)return t;const n=wo(e);return ut.push(n),n},wo=e=>{const t=[],n={dragenter:Fo,dragover:Bo,dragleave:Vo,drop:Uo},r={};H(n,(l,i)=>{r[l]=i(e,t),e.addEventListener(l,r[l],!1)});const s={element:e,addListener:l=>(t.push(l),()=>{t.splice(t.indexOf(l),1),t.length===0&&(ut.splice(ut.indexOf(s),1),H(n,i=>{e.removeEventListener(i,r[i],!1)}))})};return s},Go=(e,t)=>("elementFromPoint"in e||(e=document),e.elementFromPoint(t.x,t.y)),$t=(e,t)=>{const n=mo(t),r=Go(n,{x:e.pageX-window.pageXOffset,y:e.pageY-window.pageYOffset});return r===t||t.contains(r)};let yr=null;const dt=(e,t)=>{try{e.dropEffect=t}catch{}},Fo=(e,t)=>n=>{n.preventDefault(),yr=n.target,t.forEach(r=>{const{element:s,onenter:l}=r;$t(n,s)&&(r.state="enter",l(ye(n)))})},Bo=(e,t)=>n=>{n.preventDefault();const r=n.dataTransfer;jt(r).then(s=>{let l=!1;t.some(i=>{const{filterElement:a,element:o,onenter:c,onexit:u,ondrag:f,allowdrop:_}=i;dt(r,"copy");const I=_(s);if(!I){dt(r,"none");return}if($t(n,o)){if(l=!0,i.state===null){i.state="enter",c(ye(n));return}if(i.state="over",a&&!I){dt(r,"none");return}f(ye(n))}else a&&!l&&dt(r,"none"),i.state&&(i.state=null,u(ye(n)))})})},Uo=(e,t)=>n=>{n.preventDefault();const r=n.dataTransfer;jt(r).then(s=>{t.forEach(l=>{const{filterElement:i,element:a,ondrop:o,onexit:c,allowdrop:u}=l;if(l.state=null,!(i&&!$t(n,a))){if(!u(s))return c(ye(n));o(ye(n),s)}})})},Vo=(e,t)=>n=>{yr===n.target&&t.forEach(r=>{const{onexit:s}=r;r.state=null,s(ye(n))})},xo=(e,t,n)=>{e.classList.add("filepond--hopper");const{catchesDropsOnPage:r,requiresDropOnElement:s,filterItems:l=u=>u}=n,i=No(e,r?document.documentElement:e,s);let a="",o="";i.allowdrop=u=>t(l(u)),i.ondrop=(u,f)=>{const _=l(f);if(!t(_)){c.ondragend(u);return}o="drag-drop",c.onload(_,u)},i.ondrag=u=>{c.ondrag(u)},i.onenter=u=>{o="drag-over",c.ondragstart(u)},i.onexit=u=>{o="drag-exit",c.ondragend(u)};const c={updateHopperState:()=>{a!==o&&(e.dataset.hopperState=o,a=o)},onload:()=>{},ondragstart:()=>{},ondrag:()=>{},ondragend:()=>{},destroy:()=>{i.destroy()}};return c};let Kt=!1;const we=[],Ar=e=>{const t=document.activeElement;if(t&&/textarea|input/i.test(t.nodeName)){let n=!1,r=t;for(;r!==document.body;){if(r.classList.contains("filepond--root")){n=!0;break}r=r.parentNode}if(!n)return}jt(e.clipboardData).then(n=>{!n.length||we.forEach(r=>r(n))})},qo=e=>{we.includes(e)||(we.push(e),!Kt&&(Kt=!0,document.addEventListener("paste",Ar)))},Ho=e=>{Mt(we,we.indexOf(e)),we.length===0&&(document.removeEventListener("paste",Ar),Kt=!1)},Yo=()=>{const e=n=>{t.onload(n)},t={destroy:()=>{Ho(e)},onload:()=>{}};return qo(e),t},Wo=({root:e,props:t})=>{e.element.id=`filepond--assistant-${t.id}`,z(e.element,"role","status"),z(e.element,"aria-live","polite"),z(e.element,"aria-relevant","additions")};let Lr=null,Pr=null;const Zt=[],ft=(e,t)=>{e.element.textContent=t},zo=e=>{e.element.textContent=""},br=(e,t,n)=>{const r=e.query("GET_TOTAL_ITEMS");ft(e,`${n} ${t}, ${r} ${r===1?e.query("GET_LABEL_FILE_COUNT_SINGULAR"):e.query("GET_LABEL_FILE_COUNT_PLURAL")}`),clearTimeout(Pr),Pr=setTimeout(()=>{zo(e)},1500)},Mr=e=>e.element.parentNode.contains(document.activeElement),Xo=({root:e,action:t})=>{if(!Mr(e))return;e.element.textContent="";const n=e.query("GET_ITEM",t.id);Zt.push(n.filename),clearTimeout(Lr),Lr=setTimeout(()=>{br(e,Zt.join(", "),e.query("GET_LABEL_FILE_ADDED")),Zt.length=0},750)},ko=({root:e,action:t})=>{if(!Mr(e))return;const n=t.item;br(e,n.filename,e.query("GET_LABEL_FILE_REMOVED"))},jo=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename,s=e.query("GET_LABEL_FILE_PROCESSING_COMPLETE");ft(e,`${r} ${s}`)},Cr=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename,s=e.query("GET_LABEL_FILE_PROCESSING_ABORTED");ft(e,`${r} ${s}`)},Et=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename;ft(e,`${t.status.main} ${r} ${t.status.sub}`)},Qo=X({create:Wo,ignoreRect:!0,ignoreRectUpdate:!0,write:J({DID_LOAD_ITEM:Xo,DID_REMOVE_ITEM:ko,DID_COMPLETE_ITEM_PROCESSING:jo,DID_ABORT_ITEM_PROCESSING:Cr,DID_REVERT_ITEM_PROCESSING:Cr,DID_THROW_ITEM_REMOVE_ERROR:Et,DID_THROW_ITEM_LOAD_ERROR:Et,DID_THROW_ITEM_INVALID:Et,DID_THROW_ITEM_PROCESSING_ERROR:Et}),tag:"span",name:"assistant"}),Nr=(e,t="-")=>e.replace(new RegExp(`${t}.`,"g"),n=>n.charAt(1).toUpperCase()),vr=(e,t=16,n=!0)=>{let r=Date.now(),s=null;return(...l)=>{clearTimeout(s);const i=Date.now()-r,a=()=>{r=Date.now(),e(...l)};i<t?n||(s=setTimeout(a,t-i)):a()}},$o=1e6,_t=e=>e.preventDefault(),Ko=({root:e,props:t})=>{const n=e.query("GET_ID");n&&(e.element.id=n);const r=e.query("GET_CLASS_NAME");r&&r.split(" ").filter(o=>o.length).forEach(o=>{e.element.classList.add(o)}),e.ref.label=e.appendChildView(e.createChildView(Jl,Y(C({},t),{translateY:null,caption:e.query("GET_LABEL_IDLE")}))),e.ref.list=e.appendChildView(e.createChildView(kl,{translateY:null})),e.ref.panel=e.appendChildView(e.createChildView(ar,{name:"panel-root"})),e.ref.assistant=e.appendChildView(e.createChildView(Qo,C({},t))),e.ref.data=e.appendChildView(e.createChildView(To,C({},t))),e.ref.measure=Ee("div"),e.ref.measure.style.height="100%",e.element.appendChild(e.ref.measure),e.ref.bounds=null,e.query("GET_STYLES").filter(o=>!fe(o.value)).map(({name:o,value:c})=>{e.element.dataset[o]=c}),e.ref.widthPrevious=null,e.ref.widthUpdated=vr(()=>{e.ref.updateHistory=[],e.dispatch("DID_RESIZE_ROOT")},250),e.ref.previousAspectRatio=null,e.ref.updateHistory=[];const s=window.matchMedia("(pointer: fine) and (hover: hover)").matches,l="PointerEvent"in window;e.query("GET_ALLOW_REORDER")&&l&&!s&&(e.element.addEventListener("touchmove",_t,{passive:!1}),e.element.addEventListener("gesturestart",_t));const i=e.query("GET_CREDITS");if(i.length===2){const o=document.createElement("a");o.className="filepond--credits",o.setAttribute("aria-hidden","true"),o.href=i[0],o.tabindex=-1,o.target="_blank",o.rel="noopener noreferrer",o.textContent=i[1],e.element.appendChild(o),e.ref.credits=o}},Zo=({root:e,props:t,actions:n})=>{if(ra({root:e,props:t,actions:n}),n.filter(N=>/^DID_SET_STYLE_/.test(N.type)).filter(N=>!fe(N.data.value)).map(({type:N,data:U})=>{const R=Nr(N.substr(8).toLowerCase(),"_");e.element.dataset[R]=U.value,e.invalidateLayout()}),e.rect.element.hidden)return;e.rect.element.width!==e.ref.widthPrevious&&(e.ref.widthPrevious=e.rect.element.width,e.ref.widthUpdated());let r=e.ref.bounds;r||(r=e.ref.bounds=ta(e),e.element.removeChild(e.ref.measure),e.ref.measure=null);const{hopper:s,label:l,list:i,panel:a}=e.ref;s&&s.updateHopperState();const o=e.query("GET_PANEL_ASPECT_RATIO"),c=e.query("GET_ALLOW_MULTIPLE"),u=e.query("GET_TOTAL_ITEMS"),f=c?e.query("GET_MAX_FILES")||$o:1,_=u===f,I=n.find(N=>N.type==="DID_ADD_ITEM");if(_&&I){const N=I.data.interactionMethod;l.opacity=0,c?l.translateY=-40:N===ie.API?l.translateX=40:N===ie.BROWSE?l.translateY=40:l.translateY=30}else _||(l.opacity=1,l.translateX=0,l.translateY=0);const d=Jo(e),T=ea(e),D=l.rect.element.height,h=!c||_?0:D,O=_?i.rect.element.marginTop:0,A=u===0?0:i.rect.element.marginBottom,L=h+O+T.visual+A,y=h+O+T.bounds+A;if(i.translateY=Math.max(0,h-i.rect.element.marginTop)-d.top,o){const N=e.rect.element.width,U=N*o;o!==e.ref.previousAspectRatio&&(e.ref.previousAspectRatio=o,e.ref.updateHistory=[]);const R=e.ref.updateHistory;R.push(N);const b=2;if(R.length>b*2){const S=R.length,v=S-10;let j=0;for(let E=S;E>=v;E--)if(R[E]===R[E-2]&&j++,j>=b)return}a.scalable=!1,a.height=U;const G=U-h-(A-d.bottom)-(_?O:0);T.visual>G?i.overflow=G:i.overflow=null,e.height=U}else if(r.fixedHeight){a.scalable=!1;const N=r.fixedHeight-h-(A-d.bottom)-(_?O:0);T.visual>N?i.overflow=N:i.overflow=null}else if(r.cappedHeight){const N=L>=r.cappedHeight,U=Math.min(r.cappedHeight,L);a.scalable=!0,a.height=N?U:U-d.top-d.bottom;const R=U-h-(A-d.bottom)-(_?O:0);L>r.cappedHeight&&T.visual>R?i.overflow=R:i.overflow=null,e.height=Math.min(r.cappedHeight,y-d.top-d.bottom)}else{const N=u>0?d.top+d.bottom:0;a.scalable=!0,a.height=Math.max(D,L-N),e.height=Math.max(D,y-N)}e.ref.credits&&a.heightCurrent&&(e.ref.credits.style.transform=`translateY(${a.heightCurrent}px)`)},Jo=e=>{const t=e.ref.list.childViews[0].childViews[0];return t?{top:t.rect.element.marginTop,bottom:t.rect.element.marginBottom}:{top:0,bottom:0}},ea=e=>{let t=0,n=0;const r=e.ref.list,s=r.childViews[0],l=s.childViews.filter(O=>O.rect.element.height),i=e.query("GET_ACTIVE_ITEMS").map(O=>l.find(A=>A.id===O.id)).filter(O=>O);if(i.length===0)return{visual:t,bounds:n};const a=s.rect.element.width,o=Wt(s,i,r.dragCoordinates),c=i[0].rect.element,u=c.marginTop+c.marginBottom,f=c.marginLeft+c.marginRight,_=c.width+f,I=c.height+u,d=typeof o!="undefined"&&o>=0?1:0,T=i.find(O=>O.markedForRemoval&&O.opacity<.45)?-1:0,D=i.length+d+T,h=Yt(a,_);return h===1?i.forEach(O=>{const A=O.rect.element.height+u;n+=A,t+=A*O.opacity}):(n=Math.ceil(D/h)*I,t=n),{visual:t,bounds:n}},ta=e=>{const t=e.ref.measureHeight||null;return{cappedHeight:parseInt(e.style.maxHeight,10)||null,fixedHeight:t===0?null:t}},Jt=(e,t)=>{const n=e.query("GET_ALLOW_REPLACE"),r=e.query("GET_ALLOW_MULTIPLE"),s=e.query("GET_TOTAL_ITEMS");let l=e.query("GET_MAX_FILES");const i=t.length;return!r&&i>1?!0:(l=r||n?l:1,be(l)&&s+i>l?(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:k("warning",0,"Max files")}),!0):!1)},na=(e,t,n)=>{const r=e.childViews[0];return Wt(r,t,{left:n.scopeLeft-r.rect.element.left,top:n.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},wr=e=>{const t=e.query("GET_ALLOW_DROP"),n=e.query("GET_DISABLED"),r=t&&!n;if(r&&!e.ref.hopper){const s=xo(e.element,l=>{const i=e.query("GET_BEFORE_DROP_FILE")||(()=>!0);return e.query("GET_DROP_VALIDATION")?l.every(o=>Re("ALLOW_HOPPER_ITEM",o,{query:e.query}).every(c=>c===!0)&&i(o)):!0},{filterItems:l=>{const i=e.query("GET_IGNORED_FILES");return l.filter(a=>Ne(a)?!i.includes(a.name.toLowerCase()):!0)},catchesDropsOnPage:e.query("GET_DROP_ON_PAGE"),requiresDropOnElement:e.query("GET_DROP_ON_ELEMENT")});s.onload=(l,i)=>{const o=e.ref.list.childViews[0].childViews.filter(u=>u.rect.element.height),c=e.query("GET_ACTIVE_ITEMS").map(u=>o.find(f=>f.id===u.id)).filter(u=>u);ae("ADD_ITEMS",l,{dispatch:e.dispatch}).then(u=>{if(Jt(e,u))return!1;e.dispatch("ADD_ITEMS",{items:u,index:na(e.ref.list,c,i),interactionMethod:ie.DROP})}),e.dispatch("DID_DROP",{position:i}),e.dispatch("DID_END_DRAG",{position:i})},s.ondragstart=l=>{e.dispatch("DID_START_DRAG",{position:l})},s.ondrag=vr(l=>{e.dispatch("DID_DRAG",{position:l})}),s.ondragend=l=>{e.dispatch("DID_END_DRAG",{position:l})},e.ref.hopper=s,e.ref.drip=e.appendChildView(e.createChildView(oo))}else!r&&e.ref.hopper&&(e.ref.hopper.destroy(),e.ref.hopper=null,e.removeChildView(e.ref.drip))},Gr=(e,t)=>{const n=e.query("GET_ALLOW_BROWSE"),r=e.query("GET_DISABLED"),s=n&&!r;s&&!e.ref.browser?e.ref.browser=e.appendChildView(e.createChildView(Kl,Y(C({},t),{onload:l=>{ae("ADD_ITEMS",l,{dispatch:e.dispatch}).then(i=>{if(Jt(e,i))return!1;e.dispatch("ADD_ITEMS",{items:i,index:-1,interactionMethod:ie.BROWSE})})}})),0):!s&&e.ref.browser&&(e.removeChildView(e.ref.browser),e.ref.browser=null)},Fr=e=>{const t=e.query("GET_ALLOW_PASTE"),n=e.query("GET_DISABLED"),r=t&&!n;r&&!e.ref.paster?(e.ref.paster=Yo(),e.ref.paster.onload=s=>{ae("ADD_ITEMS",s,{dispatch:e.dispatch}).then(l=>{if(Jt(e,l))return!1;e.dispatch("ADD_ITEMS",{items:l,index:-1,interactionMethod:ie.PASTE})})}):!r&&e.ref.paster&&(e.ref.paster.destroy(),e.ref.paster=null)},ra=J({DID_SET_ALLOW_BROWSE:({root:e,props:t})=>{Gr(e,t)},DID_SET_ALLOW_DROP:({root:e})=>{wr(e)},DID_SET_ALLOW_PASTE:({root:e})=>{Fr(e)},DID_SET_DISABLED:({root:e,props:t})=>{wr(e),Fr(e),Gr(e,t),e.query("GET_DISABLED")?e.element.dataset.disabled="disabled":e.element.removeAttribute("data-disabled")}}),sa=X({name:"root",read:({root:e})=>{e.ref.measure&&(e.ref.measureHeight=e.ref.measure.offsetHeight)},create:Ko,write:Zo,destroy:({root:e})=>{e.ref.paster&&e.ref.paster.destroy(),e.ref.hopper&&e.ref.hopper.destroy(),e.element.removeEventListener("touchmove",_t),e.element.removeEventListener("gesturestart",_t)},mixins:{styles:["height"]}}),ia=(e={})=>{let t=null;const n=rt(),r=hs(ii(n),[Si,ai(n)],[Qi,oi(n)]);r.dispatch("SET_OPTIONS",{options:e});const s=()=>{document.hidden||r.dispatch("KICK")};document.addEventListener("visibilitychange",s);let l=null,i=!1,a=!1,o=null,c=null;const u=()=>{i||(i=!0),clearTimeout(l),l=setTimeout(()=>{i=!1,o=null,c=null,a&&(a=!1,r.dispatch("DID_STOP_RESIZE"))},500)};window.addEventListener("resize",u);const f=sa(r,{id:bt()});let _=!1,I=!1;const d={_read:()=>{i&&(c=window.innerWidth,o||(o=c),!a&&c!==o&&(r.dispatch("DID_START_RESIZE"),a=!0)),I&&_&&(_=f.element.offsetParent===null),!_&&(f._read(),I=f.rect.element.hidden)},_write:m=>{const g=r.processActionQueue().filter(M=>!/^SET_/.test(M.type));_&&!g.length||(O(g),_=f._write(m,g,a),di(r.query("GET_ITEMS")),_&&r.processDispatchQueue())}},T=m=>g=>{const M={type:m};if(!g)return M;if(g.hasOwnProperty("error")&&(M.error=g.error?C({},g.error):null),g.status&&(M.status=C({},g.status)),g.file&&(M.output=g.file),g.source)M.file=g.source;else if(g.item||g.id){const P=g.item?g.item:r.query("GET_ITEM",g.id);M.file=P?ne(P):null}return g.items&&(M.items=g.items.map(ne)),/progress/.test(m)&&(M.progress=g.progress),g.hasOwnProperty("origin")&&g.hasOwnProperty("target")&&(M.origin=g.origin,M.target=g.target),M},D={DID_DESTROY:T("destroy"),DID_INIT:T("init"),DID_THROW_MAX_FILES:T("warning"),DID_INIT_ITEM:T("initfile"),DID_START_ITEM_LOAD:T("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:T("addfileprogress"),DID_LOAD_ITEM:T("addfile"),DID_THROW_ITEM_INVALID:[T("error"),T("addfile")],DID_THROW_ITEM_LOAD_ERROR:[T("error"),T("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[T("error"),T("removefile")],DID_PREPARE_OUTPUT:T("preparefile"),DID_START_ITEM_PROCESSING:T("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:T("processfileprogress"),DID_ABORT_ITEM_PROCESSING:T("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:T("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:T("processfiles"),DID_REVERT_ITEM_PROCESSING:T("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[T("error"),T("processfile")],DID_REMOVE_ITEM:T("removefile"),DID_UPDATE_ITEMS:T("updatefiles"),DID_ACTIVATE_ITEM:T("activatefile"),DID_REORDER_ITEMS:T("reorderfiles")},h=m=>{const g=C({pond:B},m);delete g.type,f.element.dispatchEvent(new CustomEvent(`FilePond:${m.type}`,{detail:g,bubbles:!0,cancelable:!0,composed:!0}));const M=[];m.hasOwnProperty("error")&&M.push(m.error),m.hasOwnProperty("file")&&M.push(m.file);const P=["type","error","file"];Object.keys(m).filter(q=>!P.includes(q)).forEach(q=>M.push(m[q])),B.fire(m.type,...M);const V=r.query(`GET_ON${m.type.toUpperCase()}`);V&&V(...M)},O=m=>{!m.length||m.filter(g=>D[g.type]).forEach(g=>{const M=D[g.type];(Array.isArray(M)?M:[M]).forEach(P=>{g.type==="DID_INIT_ITEM"?h(P(g.data)):setTimeout(()=>{h(P(g.data))},0)})})},A=m=>r.dispatch("SET_OPTIONS",{options:m}),L=m=>r.query("GET_ACTIVE_ITEM",m),y=m=>new Promise((g,M)=>{r.dispatch("REQUEST_ITEM_PREPARE",{query:m,success:P=>{g(P)},failure:P=>{M(P)}})}),N=(m,g={})=>new Promise((M,P)=>{b([{source:m,options:g}],{index:g.index}).then(V=>M(V&&V[0])).catch(P)}),U=m=>m.file&&m.id,R=(m,g)=>(typeof m=="object"&&!U(m)&&!g&&(g=m,m=void 0),r.dispatch("REMOVE_ITEM",Y(C({},g),{query:m})),r.query("GET_ACTIVE_ITEM",m)===null),b=(...m)=>new Promise((g,M)=>{const P=[],V={};if(Ze(m[0]))P.push.apply(P,m[0]),Object.assign(V,m[1]||{});else{const q=m[m.length-1];typeof q=="object"&&!(q instanceof Blob)&&Object.assign(V,m.pop()),P.push(...m)}r.dispatch("ADD_ITEMS",{items:P,index:V.index,interactionMethod:ie.API,success:g,failure:M})}),G=()=>r.query("GET_ACTIVE_ITEMS"),S=m=>new Promise((g,M)=>{r.dispatch("REQUEST_ITEM_PROCESSING",{query:m,success:P=>{g(P)},failure:P=>{M(P)}})}),v=(...m)=>{const g=Array.isArray(m[0])?m[0]:m,M=g.length?g:G();return Promise.all(M.map(y))},j=(...m)=>{const g=Array.isArray(m[0])?m[0]:m;if(!g.length){const M=G().filter(P=>!(P.status===w.IDLE&&P.origin===$.LOCAL)&&P.status!==w.PROCESSING&&P.status!==w.PROCESSING_COMPLETE&&P.status!==w.PROCESSING_REVERT_ERROR);return Promise.all(M.map(S))}return Promise.all(g.map(S))},E=(...m)=>{const g=Array.isArray(m[0])?m[0]:m;let M;typeof g[g.length-1]=="object"?M=g.pop():Array.isArray(m[0])&&(M=m[1]);const P=G();return g.length?g.map(q=>ge(q)?P[q]?P[q].id:null:q).filter(q=>q).map(q=>R(q,M)):Promise.all(P.map(q=>R(q,M)))},B=Y(C(C(C({},nt()),d),li(r,n)),{setOptions:A,addFile:N,addFiles:b,getFile:L,processFile:S,prepareFile:y,removeFile:R,moveFile:(m,g)=>r.dispatch("MOVE_ITEM",{query:m,index:g}),getFiles:G,processFiles:j,removeFiles:E,prepareFiles:v,sort:m=>r.dispatch("SORT",{compare:m}),browse:()=>{var m=f.element.querySelector("input[type=file]");m&&m.click()},destroy:()=>{B.fire("destroy",f.element),r.dispatch("ABORT_ALL"),f._destroy(),window.removeEventListener("resize",u),document.removeEventListener("visibilitychange",s),r.dispatch("DID_DESTROY")},insertBefore:m=>Sn(f.element,m),insertAfter:m=>yn(f.element,m),appendTo:m=>m.appendChild(f.element),replaceElement:m=>{Sn(f.element,m),m.parentNode.removeChild(m),t=m},restoreElement:()=>{!t||(yn(t,f.element),f.element.parentNode.removeChild(f.element),t=null)},isAttachedTo:m=>f.element===m||t===m,element:{get:()=>f.element},status:{get:()=>r.query("GET_STATUS")}});return r.dispatch("DID_INIT"),pe(B)},Br=(e={})=>{const t={};return H(rt(),(r,s)=>{t[r]=s[0]}),ia(C(C({},t),e))},la=e=>e.charAt(0).toLowerCase()+e.slice(1),oa=e=>Nr(e.replace(/^data-/,"")),Ur=(e,t)=>{H(t,(n,r)=>{H(e,(s,l)=>{const i=new RegExp(n);if(!i.test(s)||(delete e[s],r===!1))return;if(ee(r)){e[r]=l;return}const o=r.group;Q(r)&&!e[o]&&(e[o]={}),e[o][la(s.replace(i,""))]=l}),r.mapping&&Ur(e[r.group],r.mapping)})},aa=(e,t={})=>{const n=[];H(e.attributes,s=>{n.push(e.attributes[s])});const r=n.filter(s=>s.name).reduce((s,l)=>{const i=z(e,l.name);return s[oa(l.name)]=i===l.name?!0:i,s},{});return Ur(r,t),r},ca=(e,t={})=>{const n={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};Re("SET_ATTRIBUTE_TO_OPTION_MAP",n);const r=C({},t),s=aa(e.nodeName==="FIELDSET"?e.querySelector("input[type=file]"):e,n);Object.keys(s).forEach(i=>{Q(s[i])?(Q(r[i])||(r[i]={}),Object.assign(r[i],s[i])):r[i]=s[i]}),r.files=(t.files||[]).concat(Array.from(e.querySelectorAll("input:not([type=file])")).map(i=>({source:i.value,options:{type:i.dataset.type}})));const l=Br(r);return e.files&&Array.from(e.files).forEach(i=>{l.addFile(i)}),l.replaceElement(e),l},ua=(...e)=>gs(e[0])?ca(...e):Br(...e),da=["fire","_read","_write"],Vr=e=>{const t={};return vn(e,t,da),t},fa=(e,t)=>e.replace(/(?:{([a-zA-Z]+)})/g,(n,r)=>t[r]),Ea=e=>{const t=new Blob(["(",e.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(t),r=new Worker(n);return{transfer:(s,l)=>{},post:(s,l,i)=>{const a=bt();r.onmessage=o=>{o.data.id===a&&l(o.data.message)},r.postMessage({id:a,message:s},i)},terminate:()=>{r.terminate(),URL.revokeObjectURL(n)}}},_a=e=>new Promise((t,n)=>{const r=new Image;r.onload=()=>{t(r)},r.onerror=s=>{n(s)},r.src=e}),xr=(e,t)=>{const n=e.slice(0,e.size,e.type);return n.lastModifiedDate=e.lastModifiedDate,n.name=t,n},pa=e=>xr(e,e.name),qr=[],Ia=e=>{if(qr.includes(e))return;qr.push(e);const t=e({addFilter:Ei,utils:{Type:p,forin:H,isString:ee,isFile:Ne,toNaturalFileSize:er,replaceInString:fa,getExtensionFromFilename:it,getFilenameWithoutExtension:zn,guesstimateMimeType:Dr,getFileFromBlob:Ce,getFilenameFromURL:Be,createRoute:J,createWorker:Ea,createView:X,createItemAPI:ne,loadImage:_a,copyFile:pa,renameFile:xr,createBlob:xn,applyFilterChain:ae,text:W,getNumericAspectRatioFromString:Fn},views:{fileActionButton:Jn}});_i(t.options)},Ta=()=>Object.prototype.toString.call(window.operamini)==="[object OperaMini]",ma=()=>"Promise"in window,ga=()=>"slice"in Blob.prototype,ha=()=>"URL"in window&&"createObjectURL"in window.URL,Ra=()=>"visibilityState"in document,Oa=()=>"performance"in window,Da=()=>"supports"in(window.CSS||{}),Sa=()=>/MSIE|Trident/.test(window.navigator.userAgent),en=(()=>{const e=mn()&&!Ta()&&Ra()&&ma()&&ga()&&ha()&&Oa()&&(Da()||Sa());return()=>e})(),Ie={apps:[]},ya="filepond",Ae=()=>{};let Hr={},pt=Ae,tn=Ae,Yr=Ae,Wr=Ae,nn=Ae,zr=Ae,Xr=Ae;if(en()){zs(()=>{Ie.apps.forEach(n=>n._read())},n=>{Ie.apps.forEach(r=>r._write(n))});const e=()=>{document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:en,create:pt,destroy:tn,parse:Yr,find:Wr,registerPlugin:nn,setOptions:Xr}})),document.removeEventListener("DOMContentLoaded",e)};document.readyState!=="loading"?setTimeout(()=>e(),0):document.addEventListener("DOMContentLoaded",e);const t=()=>H(rt(),(n,r)=>{Hr[n]=r[1]});Hr={},t(),pt=(...n)=>{const r=ua(...n);return r.on("destroy",tn),Ie.apps.push(r),Vr(r)},tn=n=>{const r=Ie.apps.findIndex(s=>s.isAttachedTo(n));return r>=0?(Ie.apps.splice(r,1)[0].restoreElement(),!0):!1},Yr=n=>Array.from(n.querySelectorAll(`.${ya}`)).filter(l=>!Ie.apps.find(i=>i.isAttachedTo(l))).map(l=>pt(l)),Wr=n=>{const r=Ie.apps.find(s=>s.isAttachedTo(n));return r?Vr(r):null},nn=(...n)=>{n.forEach(Ia),t()},zr=()=>{const n={};return H(rt(),(r,s)=>{n[r]=s[0]}),n},Xr=n=>(Q(n)&&(Ie.apps.forEach(r=>{r.setOptions(n)}),pi(n)),zr())}function Aa(e){let t,n;return{c(){t=gt("div"),n=gt("input"),this.h()},l(r){t=In(r,"DIV",{class:!0});var s=_n(t);n=In(s,"INPUT",{type:!0,id:!0,name:!0,class:!0,accept:!0,capture:!0}),s.forEach(mt),this.h()},h(){se(n,"type","file"),se(n,"id",e[1]),se(n,"name",e[2]),se(n,"class",e[0]),se(n,"accept",e[6]),n.multiple=e[3],n.required=e[4],se(n,"capture",e[5]),se(t,"class","filepond--wrapper")},m(r,s){ss(r,t,s),En(t,n),e[24](n)},p(r,[s]){s&2&&se(n,"id",r[1]),s&4&&se(n,"name",r[2]),s&1&&se(n,"class",r[0]),s&64&&se(n,"accept",r[6]),s&8&&(n.multiple=r[3]),s&16&&(n.required=r[4]),s&32&&se(n,"capture",r[5])},i:Te,o:Te,d(r){r&&mt(t),e[24](null)}}}function La(e,t,n){const r=nn,s=en();let l,i,{class:a=void 0}=t,{id:o=void 0}=t,{name:c=void 0}=t,{allowMultiple:u=void 0}=t,{required:f=void 0}=t,{captureMethod:_=void 0}=t,{acceptedFileTypes:I=void 0}=t;const d=()=>{};let{addFile:T=d}=t,{addFiles:D=d}=t,{browse:h=d}=t,{fireSync:O=d}=t,{getFile:A=d}=t,{getFiles:L=d}=t,{moveFile:y=d}=t,{prepareFile:N=d}=t,{prepareFiles:U=d}=t,{processFile:R=d}=t,{processFiles:b=d}=t,{removeFile:G=d}=t,{removeFiles:S=d}=t,{sort:v=d}=t;as(()=>{!s||(i?i.setOptions(t):(i=pt(l,C({},t)),n(8,T=i.addFile),n(9,D=i.addFiles),n(19,G=i.removeFile),n(20,S=i.removeFiles),n(10,h=i.browse),n(11,O=i.fireSync),n(12,A=i.getFile),n(13,L=i.getFiles),n(14,y=i.moveFile),n(15,N=i.prepareFile),n(16,U=i.prepareFiles),n(17,R=i.processFile),n(18,b=i.processFiles),n(19,G=i.removeFile),n(20,S=i.removeFiles),n(21,v=i.sort)))}),cs(()=>{!i||(i.destroy(),i=void 0)});function j(E){Rt[E?"unshift":"push"](()=>{l=E,n(7,l)})}return e.$$set=E=>{n(27,t=Tt(Tt({},t),fn(E))),"class"in E&&n(0,a=E.class),"id"in E&&n(1,o=E.id),"name"in E&&n(2,c=E.name),"allowMultiple"in E&&n(3,u=E.allowMultiple),"required"in E&&n(4,f=E.required),"captureMethod"in E&&n(5,_=E.captureMethod),"acceptedFileTypes"in E&&n(6,I=E.acceptedFileTypes),"addFile"in E&&n(8,T=E.addFile),"addFiles"in E&&n(9,D=E.addFiles),"browse"in E&&n(10,h=E.browse),"fireSync"in E&&n(11,O=E.fireSync),"getFile"in E&&n(12,A=E.getFile),"getFiles"in E&&n(13,L=E.getFiles),"moveFile"in E&&n(14,y=E.moveFile),"prepareFile"in E&&n(15,N=E.prepareFile),"prepareFiles"in E&&n(16,U=E.prepareFiles),"processFile"in E&&n(17,R=E.processFile),"processFiles"in E&&n(18,b=E.processFiles),"removeFile"in E&&n(19,G=E.removeFile),"removeFiles"in E&&n(20,S=E.removeFiles),"sort"in E&&n(21,v=E.sort)},t=fn(t),[a,o,c,u,f,_,I,l,T,D,h,O,A,L,y,N,U,R,b,G,S,v,r,s,j]}class Ka extends ms{constructor(t){super();Ts(this,t,La,Aa,un,{registerPlugin:22,isSupported:23,class:0,id:1,name:2,allowMultiple:3,required:4,captureMethod:5,acceptedFileTypes:6,addFile:8,addFiles:9,browse:10,fireSync:11,getFile:12,getFiles:13,moveFile:14,prepareFile:15,prepareFiles:16,processFile:17,processFiles:18,removeFile:19,removeFiles:20,sort:21})}get registerPlugin(){return this.$$.ctx[22]}get isSupported(){return this.$$.ctx[23]}get class(){return this.$$.ctx[0]}set class(t){this.$$set({class:t}),x()}get id(){return this.$$.ctx[1]}set id(t){this.$$set({id:t}),x()}get name(){return this.$$.ctx[2]}set name(t){this.$$set({name:t}),x()}get allowMultiple(){return this.$$.ctx[3]}set allowMultiple(t){this.$$set({allowMultiple:t}),x()}get required(){return this.$$.ctx[4]}set required(t){this.$$set({required:t}),x()}get captureMethod(){return this.$$.ctx[5]}set captureMethod(t){this.$$set({captureMethod:t}),x()}get acceptedFileTypes(){return this.$$.ctx[6]}set acceptedFileTypes(t){this.$$set({acceptedFileTypes:t}),x()}get addFile(){return this.$$.ctx[8]}set addFile(t){this.$$set({addFile:t}),x()}get addFiles(){return this.$$.ctx[9]}set addFiles(t){this.$$set({addFiles:t}),x()}get browse(){return this.$$.ctx[10]}set browse(t){this.$$set({browse:t}),x()}get fireSync(){return this.$$.ctx[11]}set fireSync(t){this.$$set({fireSync:t}),x()}get getFile(){return this.$$.ctx[12]}set getFile(t){this.$$set({getFile:t}),x()}get getFiles(){return this.$$.ctx[13]}set getFiles(t){this.$$set({getFiles:t}),x()}get moveFile(){return this.$$.ctx[14]}set moveFile(t){this.$$set({moveFile:t}),x()}get prepareFile(){return this.$$.ctx[15]}set prepareFile(t){this.$$set({prepareFile:t}),x()}get prepareFiles(){return this.$$.ctx[16]}set prepareFiles(t){this.$$set({prepareFiles:t}),x()}get processFile(){return this.$$.ctx[17]}set processFile(t){this.$$set({processFile:t}),x()}get processFiles(){return this.$$.ctx[18]}set processFiles(t){this.$$set({processFiles:t}),x()}get removeFile(){return this.$$.ctx[19]}set removeFile(t){this.$$set({removeFile:t}),x()}get removeFiles(){return this.$$.ctx[20]}set removeFiles(t){this.$$set({removeFiles:t}),x()}get sort(){return this.$$.ctx[21]}set sort(t){this.$$set({sort:t}),x()}}export{Va as A,Tt as B,$a as C,Ma as D,Na as E,va as F,Ca as G,En as H,Te as I,Ka as J,ba as K,wa as L,Rt as M,ka as N,qa as O,ms as S,_n as a,se as b,In as c,mt as d,gt as e,ss as f,os as g,Ua as h,Ts as i,ja as j,Ga as k,Fa as l,Qa as m,Ba as n,_s as o,za as p,Xa as q,Ha as r,un as s,ht as t,Wa as u,ps as v,Ya as w,Es as x,xa as y,as as z};
